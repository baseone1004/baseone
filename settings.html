<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BaseOne Settings</title>
  <style>
    :root{
      --bg:#0f1630; --panel:rgba(255,255,255,.06); --text:#f8faff; --muted:rgba(248,250,255,.75);
      --border:rgba(255,255,255,.14); --primary:#7aa7ff; --good:#38e1c1; --danger:#ff7b7b;
      --shadow:0 10px 24px rgba(0,0,0,.22);
    }
    body{margin:0;font-family:system-ui,-apple-system,"Noto Sans KR",Segoe UI,Roboto,sans-serif;background:linear-gradient(180deg,var(--bg),#0a1022);color:var(--text);font-size:13px}
    .wrap{max-width:920px;margin:0 auto;padding:14px}
    .top{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
    .box{margin-top:12px;background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:12px;box-shadow:var(--shadow)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    input{width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);outline:none}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .small{color:var(--muted);font-size:12px}
    .btn{padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;font-weight:900}
    .btn.primary{background:linear-gradient(135deg,var(--primary),#2f6bff);border:none}
    .btn.good{background:linear-gradient(135deg,var(--good),#1fb6ff);border:none}
    .btn.danger{background:rgba(255,107,107,.10);border:1px solid rgba(255,107,107,.35);color:var(--danger)}
    .hint{margin-top:8px;padding:10px;border-radius:12px;border:1px solid rgba(122,167,255,.35);background:rgba(122,167,255,.10);color:var(--muted)}
    a{color:inherit;text-decoration:none}
  </style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <div>
      <div style="font-size:18px;font-weight:900">âš™ï¸ BaseOne ì„¤ì •</div>
      <div class="small">API í‚¤/ë¸”ë¡œê·¸ ëª©ë¡ì„ ì €ì¥í•©ë‹ˆë‹¤ (ë‚´ PC ë¸Œë¼ìš°ì €ì— ì €ì¥ë¨)</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <a href="/"><button class="btn">â¬…ï¸ ë©”ì¸</button></a>
      <button class="btn primary" onclick="save()">ğŸ’¾ ì €ì¥</button>
      <button class="btn danger" onclick="resetAll()">â™»ï¸ ì´ˆê¸°í™”</button>
    </div>
  </div>

  <div class="box">
    <div style="font-weight:900">1) ì„œë²„ ì£¼ì†Œ</div>
    <div class="small" style="margin-top:6px">Render ë°°í¬ ì£¼ì†Œë¥¼ ë„£ì–´ì•¼ ì™¸ë¶€ì—ì„œë„ ë™ì‘í•´ìš”</div>
    <div style="margin-top:10px">
      <input id="backend" placeholder="ì˜ˆ: https://baseone11.onrender.com" />
    </div>
  </div>

  <div class="box">
    <div style="font-weight:900">2) API í‚¤</div>
    <div class="grid">
      <div>
        <div class="small"><b>GEMINI_API_KEY</b></div>
        <input id="gemini_key" placeholder="Gemini API Key ì…ë ¥" />
      </div>
      <div>
        <div class="small"><b>PEXELS_API_KEY</b></div>
        <input id="pexels_key" placeholder="Pexels API Key ì…ë ¥" />
      </div>
    </div>
    <div class="hint">
      âœ… Gemini í‚¤ëŠ” ê¸€ ìƒì„±ì— ì‚¬ìš©<br/>
      âœ… Pexels í‚¤ëŠ” ì¸ë„¤ì¼ ì´ë¯¸ì§€ URL ê°€ì ¸ì˜¤ëŠ”ë° ì‚¬ìš©
    </div>
  </div>

  <div class="box">
    <div class="row">
      <div>
        <div style="font-weight:900">3) ë¸”ë¡œê·¸ ëª©ë¡</div>
        <div class="small">ë¸”ë¡œê·¸ìŠ¤íŒŸ 10ê°œ / ë„¤ì´ë²„ 3ê°œë§Œ ì‚¬ìš©</div>
      </div>
      <button class="btn good" onclick="loadBloggerBlogs()">ğŸŸ¦ Bloggerì—ì„œ ìë™ ë¶ˆëŸ¬ì˜¤ê¸°(ì„ íƒ)</button>
    </div>

    <div class="grid">
      <div>
        <div style="font-weight:900;margin-top:10px">ğŸŸ¦ ë¸”ë¡œê·¸ìŠ¤íŒŸ URL (ìµœëŒ€ 10)</div>
        <div id="blogspotWrap"></div>
      </div>
      <div>
        <div style="font-weight:900;margin-top:10px">ğŸŸ© ë„¤ì´ë²„ ë¸”ë¡œê·¸ URL (ìµœëŒ€ 3)</div>
        <div id="naverWrap"></div>
      </div>
    </div>

    <div class="hint">
      ğŸŸ¦ ë¸”ë¡œê·¸ìŠ¤íŒŸ â€œìë™ë°œí–‰â€ì€ OAuth ì—°ê²°ì´ í•„ìˆ˜ì…ë‹ˆë‹¤. ë©”ì¸ì—ì„œ OAuth ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.
    </div>
  </div>

</div>

<script>
const KEY="baseone_settings_v4";

function makeInputs(containerId, count, prefix){
  const wrap=document.getElementById(containerId);
  wrap.innerHTML="";
  for(let i=0;i<count;i++){
    const inp=document.createElement("input");
    inp.id = `${prefix}_${i}`;
    inp.placeholder = `${i+1}ë²ˆ URL`;
    inp.style.marginTop="8px";
    wrap.appendChild(inp);
  }
}

makeInputs("blogspotWrap", 10, "blogspot");
makeInputs("naverWrap", 3, "naver");

function load(){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");
  document.getElementById("backend").value = d.backend || "";
  document.getElementById("gemini_key").value = d.gemini_key || "";
  document.getElementById("pexels_key").value = d.pexels_key || "";

  (d.blogspot||[]).forEach((u,i)=>{
    const el=document.getElementById(`blogspot_${i}`);
    if(el) el.value=u;
  });
  (d.naver||[]).forEach((u,i)=>{
    const el=document.getElementById(`naver_${i}`);
    if(el) el.value=u;
  });
}

function save(){
  const backend = (document.getElementById("backend").value||"").trim().replace(/\/+$/,"");
  const gemini_key = (document.getElementById("gemini_key").value||"").trim();
  const pexels_key = (document.getElementById("pexels_key").value||"").trim();

  const blogspot=[];
  for(let i=0;i<10;i++){
    const v=(document.getElementById(`blogspot_${i}`).value||"").trim();
    if(v) blogspot.push(v);
  }

  const naver=[];
  for(let i=0;i<3;i++){
    const v=(document.getElementById(`naver_${i}`).value||"").trim();
    if(v) naver.push(v);
  }

  const out={backend, gemini_key, pexels_key, blogspot, naver};
  localStorage.setItem(KEY, JSON.stringify(out));
  alert("ì €ì¥ ì™„ë£Œ!");
}

function resetAll(){
  if(!confirm("ì„¤ì •ì„ ì´ˆê¸°í™”í• ê¹Œìš”?")) return;
  localStorage.removeItem(KEY);
  load();
  alert("ì´ˆê¸°í™” ì™„ë£Œ!");
}

function apiBase(){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");
  return (d.backend || "").trim().replace(/\/+$/,"");
}

// ì„ íƒ: blogger blogs ìë™ ë¶ˆëŸ¬ì˜¤ê¸°
async function loadBloggerBlogs(){
  const base = apiBase();
  if(!base){
    alert("ë¨¼ì € ì„œë²„ ì£¼ì†Œë¥¼ ì €ì¥í•˜ì„¸ìš”.");
    return;
  }
  try{
    const res = await fetch(base + "/api/blogger/blogs");
    const j = await res.json().catch(()=>({}));
    if(!res.ok || !j.ok){
      alert("ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: " + (j.error || "OAuth í•„ìš”í•  ìˆ˜ ìˆì–´ìš”. ë©”ì¸ì—ì„œ OAuth ë¨¼ì € ì—°ê²°í•˜ì„¸ìš”."));
      return;
    }
    const items = j.items || [];
    // urlì„ blogspot ì…ë ¥ì¹¸ì— ì±„ì›€
    for(let i=0;i<10;i++){
      const el=document.getElementById(`blogspot_${i}`);
      if(el) el.value = items[i]?.url || "";
    }
    alert("ë¸”ë¡œê·¸ìŠ¤íŒŸ ëª©ë¡ì„ ì±„ì› ì–´ìš”. ì €ì¥ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì €ì¥í•˜ì„¸ìš”!");
  }catch(e){
    alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
  }
}

load();
</script>
</body>
</html>
