<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BaseOne ì„¤ì •</title>
<style>
  :root{
    --bg:#0b1020; --panel:#121a33; --panel2:#0f1530;
    --line:rgba(255,255,255,.10);
    --text:#eaf0ff; --sub:#b9c6ff;
    --blue:#4f8cff; --blue2:#2f6bff;
    --green:#2dd4bf; --warn:#fbbf24;
    --red:#ff6b6b;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:radial-gradient(1200px 800px at 20% 10%, #1a2a5a 0%, var(--bg) 45%), var(--bg); color:var(--text)}
  a{color:inherit;text-decoration:none}
  .wrap{max-width:980px;margin:0 auto;padding:18px}
  .top{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:12px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,#4f8cff,#2dd4bf);display:grid;place-items:center;font-weight:900}
  .title{font-size:22px;font-weight:900}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;font-weight:800}
  .btn.primary{background:linear-gradient(135deg,var(--blue),var(--blue2));border:none}
  .btn.danger{background:rgba(255,107,107,.12);border:1px solid rgba(255,107,107,.35);color:#ffd1d1}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));border:1px solid var(--line);border-radius:18px;padding:14px}
  h2{margin:0 0 10px;font-size:16px}
  h3{margin:16px 0 10px;font-size:15px}
  .small{font-size:12px;color:var(--sub);line-height:1.5}
  label{display:block;font-size:12px;color:var(--sub);margin-top:10px;margin-bottom:6px}
  input,select,textarea{
    width:100%;padding:10px;border-radius:12px;border:1px solid var(--line);
    background:rgba(15,21,48,.8);color:var(--text);outline:none
  }
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
  .cols{display:grid;grid-template-columns:1fr;gap:10px}
  @media(min-width:900px){.cols{grid-template-columns:1fr 1fr}}
  .hint{border-left:3px solid var(--green);padding:10px 12px;border-radius:12px;background:rgba(45,212,191,.08);border:1px solid rgba(45,212,191,.25)}
  .warn{border-left:3px solid var(--warn);padding:10px 12px;border-radius:12px;background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.25)}
  .list{margin:8px 0 0 0;padding-left:18px;color:var(--sub);font-size:12px;line-height:1.6}
  .foot{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .ok{color:#9ff5d2;font-weight:800}

  /* âœ… ë™ì  ë¦¬ìŠ¤íŠ¸ UI */
  .dynBox{margin-top:10px;display:flex;flex-direction:column;gap:10px}
  .dynItem{
    display:flex; gap:10px; align-items:center;
    background:rgba(255,255,255,.03);
    border:1px solid var(--line);
    border-radius:14px;
    padding:10px;
  }
  .dynItem input{flex:1; margin:0}
  .pill{
    display:inline-block;padding:6px 10px;border-radius:999px;
    background:rgba(15,21,48,.75);border:1px solid var(--line);
    color:var(--sub);font-size:12px
  }
</style>
</head>
<body>
<div class="wrap">

  <div class="top">
    <div class="brand">
      <div class="logo">B</div>
      <div>
        <div class="title">BaseOne ì„¤ì •</div>
        <div class="small">í‚¤/ì£¼ì†ŒëŠ” ë‚´ PC(ë¸Œë¼ìš°ì €)ì—ë§Œ ì €ì¥ë¼ìš”.</div>
      </div>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <a href="./index.html"><button class="btn">â† ë©”ì¸</button></a>
      <button class="btn primary" onclick="saveAll()">ğŸ’¾ ì €ì¥</button>
    </div>
  </div>

  <div class="warn small">
    âš ï¸ GitHub Pagesì—ì„œëŠ” ë³´ì•ˆìƒ <b>127.0.0.1 ì„œë²„ í˜¸ì¶œì´ ë§‰í ìˆ˜ ìˆì–´ìš”</b>.  
    ì‹¤ì œ AI ìƒì„±/ë°œí–‰ì€ <b>ë¡œì»¬ì—ì„œ server.py ì‹¤í–‰</b>í–ˆì„ ë•Œ ì•ˆì •ì ì…ë‹ˆë‹¤.
  </div>

  <div class="grid" style="margin-top:12px">

    <div class="card">
      <h2>1) ê¸€ ì‘ì„± API í‚¤</h2>
      <div class="cols">
        <div>
          <label>Gemini API Key</label>
          <input id="gemini_key" placeholder="AIza..." />
          <div class="hint small">
            <b>Gemini ë°œê¸‰ ë°©ë²•</b>
            <ul class="list">
              <li>Google AI Studio ì ‘ì†</li>
              <li><b>API í‚¤</b> ë©”ë‰´ â†’ <b>API í‚¤ ë§Œë“¤ê¸°</b></li>
              <li>ìƒì„±ëœ í‚¤ë¥¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°</li>
            </ul>
          </div>
        </div>

        <div>
          <label>ChatGPT API Key (OpenAI)</label>
          <input id="openai_key" placeholder="sk-..." />
          <div class="hint small">
            <b>OpenAI ë°œê¸‰ ë°©ë²•</b>
            <ul class="list">
              <li>OpenAI ë¡œê·¸ì¸</li>
              <li>API Keys â†’ Create new secret key</li>
              <li>ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°</li>
            </ul>
          </div>
        </div>

        <div>
          <label>Genspark API Key</label>
          <input id="genspark_key" placeholder="Genspark í‚¤" />
          <div class="hint small">
            <b>Genspark ë°œê¸‰ ë°©ë²•</b>
            <ul class="list">
              <li>Genspark ê°œë°œì/ì„¤ì • í˜ì´ì§€</li>
              <li>API Key ìƒì„± â†’ ë³µì‚¬</li>
              <li>ë¶™ì—¬ë„£ê¸°</li>
            </ul>
          </div>
        </div>

        <div>
          <label>ê¸°ë³¸ ê¸€ ì‘ì„± ì—”ì§„</label>
          <select id="text_provider">
            <option value="gemini">Gemini</option>
            <option value="chatgpt">ChatGPT</option>
            <option value="genspark">Genspark</option>
          </select>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>2) ì´ë¯¸ì§€ ìƒì„±/ë¬´ë£Œ ì´ë¯¸ì§€</h2>
      <div class="cols">
        <div>
          <label>Gemini Image Key</label>
          <input id="gemini_img_key" placeholder="Gemini ì´ë¯¸ì§€ í‚¤(ê°™ì€ í‚¤ ì‚¬ìš© ê°€ëŠ¥)" />
          <div class="small" style="margin-top:8px">
            ë³´í†µ Gemini í…ìŠ¤íŠ¸ í‚¤ì™€ ë™ì¼ í‚¤ë¡œë„ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ, ê¶Œí•œ/ìš”ê¸ˆì œì— ë”°ë¼ ì œí•œë  ìˆ˜ ìˆì–´ìš”.
          </div>
        </div>

        <div>
          <label>Wisk Key</label>
          <input id="wisk_key" placeholder="Wisk í‚¤" />
        </div>

        <div>
          <label>âœ… Pexels API Key (ë¬´ë£Œ ì´ë¯¸ì§€)</label>
          <input id="pexels_key" placeholder="Pexels í‚¤" />
          <div class="hint small">
            <b>Pexels ë°œê¸‰ ë°©ë²•</b>
            <ul class="list">
              <li>Pexels ë¡œê·¸ì¸</li>
              <li>Developers / API ë©”ë‰´</li>
              <li>API Key ìƒì„± â†’ ë³µì‚¬ â†’ ë¶™ì—¬ë„£ê¸°</li>
            </ul>
          </div>
        </div>

        <div>
          <label>ê¸°ë³¸ ì´ë¯¸ì§€ ì—”ì§„</label>
          <select id="img_provider">
            <option value="pexels">Pexels(ë¬´ë£Œ)</option>
            <option value="gemini">Gemini</option>
            <option value="wisk">Wisk</option>
          </select>
          <div class="small" style="margin-top:8px">
            ë¬´ë£Œë¡œ ì“°ë ¤ë©´ <b>Pexels</b> ì¶”ì²œ!
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>3) ë¸”ë¡œê·¸ ì—°ê²° (ì£¼ì†Œ ì €ì¥)</h2>
      <div class="small">âœ… ì´ì œëŠ” â€œ+ì¶”ê°€â€ ë²„íŠ¼ìœ¼ë¡œ í•„ìš”í•œ ë§Œí¼ë§Œ ì…ë ¥ì¹¸ì´ ëŠ˜ì–´ë‚˜ìš”.</div>

      <h3>ë¸”ë¡œê·¸ìŠ¤íŒŸ <span class="pill">ìµœëŒ€ 10ê°œ</span></h3>
      <div class="row">
        <div class="small">ì£¼ì†Œë¥¼ ë„£ê³  +ì¶”ê°€ë¡œ ëŠ˜ë¦¬ì„¸ìš”.</div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn" onclick="addBlogRow('blogspot')">+ ì¶”ê°€</button>
          <button class="btn danger" onclick="clearBlogRows('blogspot')">ì „ì²´ì‚­ì œ</button>
        </div>
      </div>
      <div class="dynBox" id="blogspot_box"></div>

      <h3 style="margin-top:18px">ë„¤ì´ë²„ <span class="pill">ìµœëŒ€ 3ê°œ</span></h3>
      <div class="row">
        <div class="small">ë„¤ì´ë²„ ê¸€ì“°ê¸° URL/ë¸”ë¡œê·¸ ì£¼ì†Œë¥¼ ì €ì¥í•˜ëŠ” ë‹¨ê³„</div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn" onclick="addBlogRow('naver')">+ ì¶”ê°€</button>
          <button class="btn danger" onclick="clearBlogRows('naver')">ì „ì²´ì‚­ì œ</button>
        </div>
      </div>
      <div class="dynBox" id="naver_box"></div>

      <h3 style="margin-top:18px">í‹°ìŠ¤í† ë¦¬ <span class="pill">ìµœëŒ€ 10ê°œ</span></h3>
      <div class="row">
        <div class="small">í‹°ìŠ¤í† ë¦¬ ë¸”ë¡œê·¸ ì£¼ì†Œë¥¼ ì €ì¥í•˜ëŠ” ë‹¨ê³„</div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn" onclick="addBlogRow('tistory')">+ ì¶”ê°€</button>
          <button class="btn danger" onclick="clearBlogRows('tistory')">ì „ì²´ì‚­ì œ</button>
        </div>
      </div>
      <div class="dynBox" id="tistory_box"></div>

      <div class="foot">
        <button class="btn primary" onclick="saveAll()">ğŸ’¾ ì €ì¥</button>
        <span id="msg" class="small"></span>
      </div>
    </div>

    <div class="card">
      <h2>4) ì„œë²„ ì£¼ì†Œ</h2>
      <label>ë¡œì»¬ ì„œë²„ ì£¼ì†Œ</label>
      <input id="backend" placeholder="https://baseone-api.onrender.com" />
      <button class="btn" onclick="testServer()">ì„œë²„ ì—°ê²° í™•ì¸</button>
      <div id="serverMsg" class="small"></div>
    </div>

  </div>
</div>

<script>
const KEY = "baseone_settings_v3"; // ì„¤ì •ì°½ ì €ì¥
const KEY_V2 = "baseone_settings_v2"; // âœ… ë©”ì¸(index.html)ì´ ì½ëŠ” í‚¤

const LIMITS = { blogspot: 10, naver: 3, tistory: 10 };

function rowTemplate(type, idx, value){
  const labelMap = { blogspot:"ë¸”ë¡œê·¸ìŠ¤íŒŸ", naver:"ë„¤ì´ë²„", tistory:"í‹°ìŠ¤í† ë¦¬" };
  const safeVal = (value || "").replaceAll('"','&quot;');
  return `
    <div class="dynItem" data-type="${type}">
      <div style="min-width:86px;font-weight:800">${labelMap[type]} ${idx}</div>
      <input class="dynInput" placeholder="https://..." value="${safeVal}" />
      <button class="btn danger" onclick="removeRow(this)">ì‚­ì œ</button>
    </div>
  `;
}

function getBox(type){ return document.getElementById(type + "_box"); }

function countRows(type){
  return getBox(type).querySelectorAll('.dynItem').length;
}

function renumber(type){
  const items = getBox(type).querySelectorAll('.dynItem');
  items.forEach((item,i)=>{
    const labelMap = { blogspot:"ë¸”ë¡œê·¸ìŠ¤íŒŸ", naver:"ë„¤ì´ë²„", tistory:"í‹°ìŠ¤í† ë¦¬" };
    item.querySelector('div').textContent = `${labelMap[type]} ${i+1}`;
  });
}

function addBlogRow(type, value=""){
  const box = getBox(type);
  const n = countRows(type);
  if(n >= LIMITS[type]){
    alert(`ìµœëŒ€ ${LIMITS[type]}ê°œê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
    return;
  }
  box.insertAdjacentHTML("beforeend", rowTemplate(type, n+1, value));
}

function removeRow(btn){
  const item = btn.closest('.dynItem');
  const type = item.getAttribute('data-type');
  item.remove();
  renumber(type);
}

function clearBlogRows(type){
  if(!confirm("ì •ë§ ì „ì²´ ì‚­ì œí• ê¹Œìš”?")) return;
  getBox(type).innerHTML = "";
  // ìµœì†Œ 1ì¹¸ì€ ë‚¨ê²¨ë‘ê¸°(í¸ì˜)
  addBlogRow(type, "");
}

function collectValues(type){
  const items = getBox(type).querySelectorAll('.dynItem .dynInput');
  return Array.from(items).map(i=> (i.value||"").trim()).filter(Boolean);
}

function saveAll(){
  const data = {
    gemini_key: gemini_key.value.trim(),
    openai_key: openai_key.value.trim(),
    genspark_key: genspark_key.value.trim(),
    text_provider: text_provider.value,
    gemini_img_key: gemini_img_key.value.trim(),
    wisk_key: wisk_key.value.trim(),
    pexels_key: pexels_key.value.trim(),
    img_provider: img_provider.value,
    backend: backend.value.trim() || "http://127.0.0.1:5000",
    blogspot: collectValues("blogspot"),
    naver: collectValues("naver"),
    tistory: collectValues("tistory")
  };

  localStorage.setItem(KEY, JSON.stringify(data));
  msg.innerHTML = `<span class="ok">ì €ì¥ ì™„ë£Œ âœ…</span>`;

  // âœ… ë©”ì¸(index.html)ì´ ì½ëŠ” v2 í¬ë§·ë„ ê°™ì´ ì €ì¥
  const v2 = {
    blogs: {
      blogspot: (data.blogspot || []),
      naver: (data.naver || []),
      tistory: (data.tistory || [])
    },
    imgProvider: data.img_provider || "pexels",
    pexelsKey: data.pexels_key || ""
  };
  localStorage.setItem(KEY_V2, JSON.stringify(v2));
}

(function load(){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");

  gemini_key.value = d.gemini_key || "";
  openai_key.value = d.openai_key || "";
  genspark_key.value = d.genspark_key || "";
  text_provider.value = d.text_provider || "gemini";
  gemini_img_key.value = d.gemini_img_key || "";
  wisk_key.value = d.wisk_key || "";
  pexels_key.value = d.pexels_key || "";
  img_provider.value = d.img_provider || "pexels";
  backend.value = d.backend || "http://127.0.0.1:5000";

  // âœ… ë™ì  ë¦¬ìŠ¤íŠ¸: ì €ì¥ëœ ê°’ë§Œí¼ë§Œ ìƒì„± (ì—†ìœ¼ë©´ 1ì¹¸)
  const bs = (d.blogspot && d.blogspot.length) ? d.blogspot : [""];
  const nv = (d.naver && d.naver.length) ? d.naver : [""];
  const ts = (d.tistory && d.tistory.length) ? d.tistory : [""];

  getBox("blogspot").innerHTML = "";
  bs.slice(0, LIMITS.blogspot).forEach(v => addBlogRow("blogspot", v));

  getBox("naver").innerHTML = "";
  nv.slice(0, LIMITS.naver).forEach(v => addBlogRow("naver", v));

  getBox("tistory").innerHTML = "";
  ts.slice(0, LIMITS.tistory).forEach(v => addBlogRow("tistory", v));
})();

async function testServer(){
  const base = (backend.value || "http://127.0.0.1:5000").trim();
  serverMsg.textContent = "í™•ì¸ ì¤‘...";
  try{
    const res = await fetch(base + "/health");
    const j = await res.json();
    serverMsg.innerHTML = `<span class="ok">ì—°ê²° OK âœ…</span> <span class="small">${j.time||""}</span>`;
  }catch(e){
    serverMsg.innerHTML = `<span style="color:#ffb4b4;font-weight:800">ì—°ê²° ì‹¤íŒ¨ âŒ</span> <span class="small">ì„œë²„ë¥¼ ë¨¼ì € ì¼œì„¸ìš” (python server.py)</span>`;
  }
}
</script>
</body>
</html>

