<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BaseOne ì„¤ì •</title>
  <style>
    :root{--bg:#0f1630;--panel:rgba(255,255,255,.06);--text:#f8faff;--muted:rgba(248,250,255,.7);--border:rgba(255,255,255,.14);--primary:#7aa7ff;--good:#38e1c1;--danger:#ff7b7b;}
    body{margin:0;font-family:system-ui,-apple-system,"Noto Sans KR",Segoe UI,Roboto,sans-serif;background:linear-gradient(180deg,var(--bg),#0a1022);color:var(--text);font-size:13px}
    .wrap{max-width:980px;margin:0 auto;padding:14px}
    .top{display:flex;justify-content:space-between;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:10px}
    .box{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:12px;margin:10px 0}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    input,select,textarea{width:100%;padding:9px 10px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);outline:none}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:900px){.grid2{grid-template-columns:1fr}}
    .btn{padding:9px 12px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;font-weight:900}
    .btn.primary{background:linear-gradient(135deg,var(--primary),#2f6bff);border:none}
    .btn.good{background:linear-gradient(135deg,var(--good),#1fb6ff);border:none}
    .btn.danger{background:rgba(255,107,107,.10);border:1px solid rgba(255,107,107,.35);color:var(--danger)}
    .small{font-size:12px;color:var(--muted);line-height:1.5}
    .h{font-weight:900;margin-bottom:6px}
    .tag{display:inline-flex;gap:6px;align-items:center;padding:5px 9px;border-radius:999px;border:1px solid var(--border);color:var(--muted);font-size:12px}
  </style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <div>
      <div style="font-size:18px;font-weight:900">âš™ï¸ BaseOne ì„¤ì •</div>
      <div class="small">ì—¬ê¸°ì„œ ì €ì¥í•˜ë©´ ë©”ì¸(index)ì—ì„œ ë°”ë¡œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <a href="/"><button class="btn">â† ë©”ì¸</button></a>
      <button class="btn primary" onclick="save()">ğŸ’¾ ì €ì¥</button>
      <button class="btn danger" onclick="resetAll()">â™»ï¸ ì´ˆê¸°í™”</button>
    </div>
  </div>

  <div class="box">
    <div class="h">1) ì„œë²„ ì£¼ì†Œ</div>
    <div class="small">Render ë°°í¬ ì£¼ì†Œë¥¼ ë„£ê±°ë‚˜, ë¡œì»¬ì´ë©´ ê¸°ë³¸ê°’ ê·¸ëŒ€ë¡œ ë‘ë©´ ë©ë‹ˆë‹¤.</div>
    <div style="margin-top:8px">
      <input id="backend" placeholder="ì˜ˆ: https://xxxx.onrender.com (ë˜ëŠ” http://127.0.0.1:5000)"/>
    </div>
  </div>

  <div class="box">
    <div class="h">2) API í‚¤</div>
    <div class="small">
      <span class="tag">GEMINI_API_KEY</span> : êµ¬ê¸€ Gemini API í˜¸ì¶œìš© í‚¤(ê¸€ ìƒì„±).  
      <span class="tag">PEXELS_API_KEY</span> : Pexels ì´ë¯¸ì§€ ê²€ìƒ‰ í‚¤.
    </div>

    <div class="grid2" style="margin-top:10px">
      <div>
        <div class="small"><b>GEMINI_API_KEY</b></div>
        <input id="gemini_key" placeholder="AIza..."/>
      </div>
      <div>
        <div class="small"><b>GEMINI ëª¨ë¸(ê¸€)</b></div>
        <input id="gemini_model" placeholder="ì˜ˆ: gemini-2.0-flash"/>
      </div>
      <div>
        <div class="small"><b>PEXELS_API_KEY</b></div>
        <input id="pexels_key" placeholder="pexels key"/>
      </div>
      <div>
        <div class="small"><b>ì´ë¯¸ì§€ ì œê³µì</b></div>
        <select id="img_provider">
          <option value="pexels">pexels (ì¶”ì²œ/ì•ˆì •)</option>
          <option value="gemini">gemini (ì¶”í›„ í™•ì¥)</option>
        </select>
      </div>
    </div>

    <div class="small" style="margin-top:10px">
      ì°¸ê³ : Gemini ìª½ì— ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸ë„ ìˆì§€ë§Œ, í™˜ê²½/ëª¨ë¸/ì •ì±… ë³€ê²½ì´ ì¦ì•„ì„œ ìš°ì„ ì€ Pexelsë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì¡ëŠ” ê²Œ ì•ˆì •ì ì…ë‹ˆë‹¤. :contentReference[oaicite:2]{index=2}
    </div>
  </div>

  <div class="box">
    <div class="h">3) ë¸”ë¡œê·¸ ì£¼ì†Œ ì €ì¥</div>
    <div class="small">ë¸”ë¡œê·¸ìŠ¤íŒŸ 10ê°œ / ë„¤ì´ë²„ 3ê°œ / í‹°ìŠ¤í† ë¦¬ ì—¬ëŸ¬ê°œ ì €ì¥</div>

    <div style="margin-top:10px" class="grid2">
      <div>
        <div class="h">ğŸŸ¦ ë¸”ë¡œê·¸ìŠ¤íŒŸ (ìµœëŒ€ 10ê°œ)</div>
        <div id="blogspotBox"></div>
      </div>
      <div>
        <div class="h">ğŸŸ© ë„¤ì´ë²„ (ìµœëŒ€ 3ê°œ)</div>
        <div id="naverBox"></div>

        <div class="h" style="margin-top:12px">ğŸŸ§ í‹°ìŠ¤í† ë¦¬ (ì—¬ëŸ¬ê°œ)</div>
        <div id="tistoryBox"></div>
        <button class="btn" style="margin-top:8px" onclick="addTistory()">+ í‹°ìŠ¤í† ë¦¬ ì¶”ê°€</button>
      </div>
    </div>
  </div>

  <div class="box">
    <div class="h">4) ë¸”ë¡œê·¸ìŠ¤íŒŸ OAuth</div>
    <div class="small">ë¸”ë¡œê·¸ìŠ¤íŒŸ ìë™ë°œí–‰ì€ OAuth ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤.</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
      <a id="oauthLink" href="/oauth/start" target="_blank"><button class="btn good">ğŸ” OAuth ì—°ê²° ì‹œì‘</button></a>
      <button class="btn" onclick="checkOAuth()">ì—°ê²° ìƒíƒœ í™•ì¸</button>
      <span class="tag" id="oauthStatus">-</span>
    </div>
  </div>
</div>

<script>
const KEY="baseone_settings_v4";

function $(id){return document.getElementById(id);}
function load(){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");

  $("backend").value = d.backend || "http://127.0.0.1:5000";
  $("gemini_key").value = d.gemini_key || "";
  $("gemini_model").value = d.gemini_model || "gemini-2.0-flash";
  $("pexels_key").value = d.pexels_key || "";
  $("img_provider").value = d.img_provider || "pexels";

  // blogspot 10
  const bs = Array.isArray(d.blogspot) ? d.blogspot : [];
  const bsBox = $("blogspotBox");
  bsBox.innerHTML="";
  for(let i=0;i<10;i++){
    const v = bs[i] || "";
    bsBox.innerHTML += `<input style="margin:6px 0" data-bs="${i}" placeholder="ë¸”ë¡œê·¸ìŠ¤íŒŸ ì£¼ì†Œ ${i+1}" value="${escapeAttr(v)}"/>`;
  }

  // naver 3
  const nv = Array.isArray(d.naver) ? d.naver : [];
  const nvBox = $("naverBox");
  nvBox.innerHTML="";
  for(let i=0;i<3;i++){
    const v = nv[i] || "";
    nvBox.innerHTML += `<input style="margin:6px 0" data-nv="${i}" placeholder="ë„¤ì´ë²„ ì£¼ì†Œ ${i+1}" value="${escapeAttr(v)}"/>`;
  }

  // tistory list
  const ts = Array.isArray(d.tistory) ? d.tistory : [];
  renderTistory(ts);
}
function renderTistory(arr){
  const box = $("tistoryBox");
  box.innerHTML = "";
  (arr||[]).forEach((v,i)=>{
    box.innerHTML += `
      <div style="display:flex;gap:8px;align-items:center;margin:6px 0">
        <input style="flex:1" data-ts="${i}" placeholder="í‹°ìŠ¤í† ë¦¬ ì£¼ì†Œ ${i+1}" value="${escapeAttr(v||"")}"/>
        <button class="btn danger" onclick="removeTistory(${i})">ì‚­ì œ</button>
      </div>
    `;
  });
  if(!arr.length){
    box.innerHTML = `<div class="small">ì €ì¥ëœ í‹°ìŠ¤í† ë¦¬ ì—†ìŒ</div>`;
  }
}
function addTistory(){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");
  d.tistory = Array.isArray(d.tistory) ? d.tistory : [];
  d.tistory.push("");
  localStorage.setItem(KEY, JSON.stringify(d));
  renderTistory(d.tistory);
}
function removeTistory(i){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");
  d.tistory = Array.isArray(d.tistory) ? d.tistory : [];
  d.tistory.splice(i,1);
  localStorage.setItem(KEY, JSON.stringify(d));
  renderTistory(d.tistory);
}

function save(){
  const d = JSON.parse(localStorage.getItem(KEY) || "{}");
  d.backend = $("backend").value.trim();
  d.gemini_key = $("gemini_key").value.trim();
  d.gemini_model = $("gemini_model").value.trim() || "gemini-2.0-flash";
  d.pexels_key = $("pexels_key").value.trim();
  d.img_provider = $("img_provider").value;

  // read blogspot inputs
  const bsInputs = document.querySelectorAll("[data-bs]");
  d.blogspot = Array.from(bsInputs).map(x=>x.value.trim()).filter(Boolean);

  // read naver
  const nvInputs = document.querySelectorAll("[data-nv]");
  d.naver = Array.from(nvInputs).map(x=>x.value.trim()).filter(Boolean);

  // read tistory
  const d2 = JSON.parse(localStorage.getItem(KEY) || "{}");
  const tsInputs = document.querySelectorAll("[data-ts]");
  d.tistory = Array.from(tsInputs).map(x=>x.value.trim()).filter(Boolean);

  localStorage.setItem(KEY, JSON.stringify(d));
  alert("ì €ì¥ ì™„ë£Œ! ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ì„œ ì‚¬ìš©í•˜ì„¸ìš”.");
}

function resetAll(){
  if(!confirm("ì´ˆê¸°í™”í• ê¹Œìš”?")) return;
  localStorage.removeItem(KEY);
  load();
}

function escapeAttr(s){
  return String(s||"").replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;");
}

async function checkOAuth(){
  const base = ($("backend").value || "http://127.0.0.1:5000").trim().replace(/\/+$/,"");
  try{
    const r = await fetch(base+"/api/oauth/status");
    const j = await r.json();
    $("oauthStatus").textContent = j.connected ? "âœ… CONNECTED" : "âŒ NOT CONNECTED";
  }catch(e){
    $("oauthStatus").textContent = "ì„œë²„ ì—°ê²° ì‹¤íŒ¨";
  }
}

load();
</script>
</body>
</html>
