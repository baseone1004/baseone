<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BaseOne - ìˆ˜ìµí˜• ê¸€ ìë™í™”</title>
<style>
body{margin:0;font-family:"Noto Sans KR",system-ui;background:#0f1630;color:#fff}
.wrap{max-width:900px;margin:0 auto;<!doctype html>
<html lang="ko"><!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BaseOne (Simple)</title>
  <style>
    :root{
      --bg:#0f1630; --panel:rgba(255,255,255,.06); --panel2:rgba(255,255,255,.08);
      --text:#f8faff; --muted:rgba(248,250,255,.75); --border:rgba(255,255,255,.14);
      --primary:#7aa7ff; --good:#38e1c1; --danger:#ff7b7b; --shadow:0 10px 24px rgba(0,0,0,.22);
    }
    [data-theme="light"]{
      --bg:#f5f7ff; --panel:#ffffff; --panel2:#f0f3ff; --text:#0f1630; --muted:rgba(15,22,48,.7);
      --border:rgba(15,22,48,.12); --primary:#2f6bff; --good:#00b894; --danger:#e74c3c; --shadow:0 10px 22px rgba(15,22,48,.10);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans KR", Segoe UI, Roboto, sans-serif;
      background:
        radial-gradient(1200px 700px at 10% 0%, rgba(122,167,255,.22), transparent 55%),
        radial-gradient(1000px 600px at 90% 20%, rgba(56,225,193,.16), transparent 55%),
        linear-gradient(180deg, var(--bg), #0a1022);
      color:var(--text);
      font-size:13px;
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:980px;margin:0 auto;padding:12px}
    .top{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;padding:8px 4px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:34px;height:34px;border-radius:12px;background:linear-gradient(135deg,var(--primary), var(--good));
      display:flex;align-items:center;justify-content:center;font-weight:900;color:#fff;box-shadow:var(--shadow)}
    .title{font-size:18px;font-weight:900;line-height:1}
    .subtitle{font-size:12px;color:var(--muted);margin-top:4px}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);
      border:1px solid var(--border);color:var(--muted);font-size:12px}
    .box{background:var(--panel);border:1px solid var(--border);padding:12px;border-radius:16px;margin:10px 0;box-shadow:var(--shadow);backdrop-filter: blur(8px)}
    [data-theme="light"] .box{backdrop-filter:none}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:space-between}
    input, select, textarea{padding:9px 10px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);outline:none;font-size:12.5px}
    [data-theme="light"] input,[data-theme="light"] select,[data-theme="light"] textarea{background:rgba(15,22,48,.04)}
    select{min-width:280px}
    .btn{padding:8px 11px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);
      cursor:pointer;font-weight:900;font-size:12px;transition:transform .05s ease, filter .15s ease}
    [data-theme="light"] .btn{background:rgba(15,22,48,.04)}
    .btn:hover{filter:brightness(1.06)} .btn:active{transform:translateY(1px)}
    .btn.primary{background:linear-gradient(135deg,var(--primary), #2f6bff);border:none;color:#fff}
    .btn.good{background:linear-gradient(135deg,var(--good), #1fb6ff);border:none;color:#fff}
    .btn.danger{background:rgba(255,107,107,.10);border:1px solid rgba(255,107,107,.35);color:var(--danger)}
    .small{font-size:12px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
    @media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    .cat{background:var(--panel2);border:1px solid var(--border);padding:10px;border-radius:14px;cursor:pointer;transition:transform .08s ease, filter .15s ease, border-color .15s ease}
    .cat:hover{transform:translateY(-1px);filter:brightness(1.05);border-color:rgba(122,167,255,.55)}
    .cat b{font-size:13px} .cat .desc{font-size:11.5px;color:var(--muted);margin-top:4px}
    .list{max-height:320px;overflow:auto;margin-top:10px;padding-right:6px}
    .item{background:var(--panel2);border:1px solid var(--border);padding:10px;border-radius:14px;display:flex;justify-content:space-between;gap:10px;align-items:center;margin-bottom:8px;cursor:pointer}
    .item.active{border-color:rgba(122,167,255,.85);box-shadow:0 0 0 2px rgba(122,167,255,.18);background:linear-gradient(135deg, rgba(122,167,255,.12), rgba(56,225,193,.10))}
    .itemTitle{font-weight:900} .itemMeta{font-size:11.5px;color:var(--muted);margin-top:4px}
    .progWrap{margin-top:10px;border:1px solid var(--border);border-radius:999px;overflow:hidden;height:12px;background:rgba(255,255,255,.08)}
    [data-theme="light"] .progWrap{background:rgba(15,22,48,.05)}
    .progBar{height:100%;width:0%;background:linear-gradient(90deg,var(--primary),var(--good));transition:width .2s ease}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    @media(max-width:900px){.two{grid-template-columns:1fr}}
    .card{background:var(--panel2);border:1px solid var(--border);border-radius:14px;padding:10px}
    .pre{margin-top:8px;border:1px solid var(--border);border-radius:12px;padding:10px;min-height:180px;white-space:pre-wrap;overflow:auto;background:rgba(0,0,0,.10)}
    [data-theme="light"] .pre{background:rgba(15,22,48,.03)}
    .iframeWrap{margin-top:8px;background:#fff;border-radius:12px;overflow:hidden;border:1px solid var(--border);min-height:320px}
    iframe{width:100%;height:320px;border:0}
    #logBox{display:none}
    #log{margin-top:10px;background:var(--panel2);border:1px solid var(--border);border-radius:12px;padding:10px;max-height:220px;overflow:auto;font-size:12px;line-height:1.6}
  </style>
</head>

<body>
<div class="wrap">
  <div class="top">
    <div class="brand">
      <div class="logo">B</div>
      <div>
        <div class="title">BaseOne</div>
        <div class="subtitle">ì£¼ì œ ì„ íƒ â†’ AI ìƒì„± â†’ ë¯¸ë¦¬ë³´ê¸° â†’ ì¦‰ì‹œë°œí–‰(ë¸”ë¡œê·¸ìŠ¤íŒŸ)</div>
      </div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <span class="pill">ğŸ›°ï¸ ì„œë²„ <b id="sv">-</b></span>
      <button class="btn" onclick="toggleTheme()">ğŸŒ“</button>
      <a href="/settings"><button class="btn">âš™ï¸ ì„¤ì •</button></a>
    </div>
  </div>

  <div class="box">
    <div class="row">
      <div>
        <b>1) ë¸”ë¡œê·¸ ì„ íƒ</b>
        <div class="small">ì„¤ì •ì—ì„œ ì €ì¥í•œ ë¸”ë¡œê·¸ê°€ ëœ¹ë‹ˆë‹¤.</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
        <select id="blogSelect"></select>
        <button class="btn" onclick="loadBlogsToSelect()">ğŸ”„</button>
        <button class="btn primary" onclick="syncBloggerBlogs()">ğŸ” ë¸”ë¡œê·¸ìŠ¤íŒŸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°</button>
        <button class="btn" onclick="startOAuth()">OAuth ì—°ê²°</button>
      </div>
    </div>
    <div class="small" style="margin-top:8px">âœ… í˜„ì¬ ì„ íƒ: <b id="blogNow">-</b></div>
  </div>

  <div class="box">
    <div class="row">
      <div>
        <b>2) ìˆ˜ìµí˜• ì£¼ì œ ì„ íƒ</b>
        <div class="small">ì¹´í…Œê³ ë¦¬ë¥¼ ëˆ„ë¥´ë©´ ì£¼ì œê°€ ìƒì„±ë©ë‹ˆë‹¤.</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
        <input id="filter" placeholder="ğŸ” ê²€ìƒ‰" oninput="renderTopics()">
        <button class="btn" onclick="copyAll()">ğŸ“‹ ì „ì²´ë³µì‚¬</button>
        <button class="btn primary" onclick="aiGenerate()">âœ¨ AI ìƒì„±</button>
      </div>
    </div>

    <div class="grid" id="catGrid"></div>

    <div class="progWrap"><div class="progBar" id="progBar"></div></div>
    <div class="small" id="progText" style="margin-top:6px">ì§„í–‰ë¥ : 0%</div>

    <div class="list" id="topicList"></div>
  </div>

  <div class="box" id="previewBox" style="display:none">
    <div class="row">
      <div>
        <b>3) ë¯¸ë¦¬ë³´ê¸° / ë°œí–‰</b>
        <div class="small" id="previewMeta">-</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" onclick="openPreviewWindow()">ğŸ§¾ ìƒˆì°½</button>
        <button class="btn good" onclick="publishNow()">ğŸš€ ì¦‰ì‹œë°œí–‰</button>
        <button class="btn" onclick="toggleLog()">ğŸ§¾ ë¡œê·¸</button>
      </div>
    </div>

    <div class="two">
      <div class="card">
        <div style="font-weight:900">ğŸ“ ë³¸ë¬¸(HTML)</div>
        <div class="pre" id="finalBody"></div>
        <div style="margin-top:8px">
          <button class="btn" onclick="navigator.clipboard.writeText(document.getElementById('finalBody').textContent);alert('ë³¸ë¬¸ ë³µì‚¬ ì™„ë£Œ!')">ë³¸ë¬¸ ë³µì‚¬</button>
        </div>
      </div>
      <div class="card">
        <div style="font-weight:900">ğŸ–¼ï¸ ì´ë¯¸ì§€(URL)</div>
        <div class="pre" id="finalImage"></div>
        <div style="margin-top:10px">
          <img id="previewImg" alt="preview" style="width:100%;border-radius:12px;border:1px solid var(--border);display:none"/>
          <div class="small" id="imgHint" style="margin-top:8px">ì´ë¯¸ì§€ URLì´ ìˆìœ¼ë©´ ì•„ë˜ì— ë³´ì…ë‹ˆë‹¤.</div>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:10px">
      <div style="font-weight:900">ğŸ‘€ HTML ë¯¸ë¦¬ë³´ê¸°</div>
      <div class="iframeWrap"><iframe id="previewIframe"></iframe></div>
    </div>

    <div class="box" id="logBox">
      <div class="row">
        <b>ğŸ§¾ ë¡œê·¸</b>
        <div style="display:flex;gap:8px">
          <button class="btn" onclick="toggleLog()">ğŸ‘€ í† ê¸€</button>
          <button class="btn danger" onclick="clearLog()">ğŸ§¹ ì§€ìš°ê¸°</button>
        </div>
      </div>
      <div id="log"></div>
    </div>
  </div>
</div>

<script>
/* Theme */
const THEME_KEY="baseone_theme_simple_v1";
(function initTheme(){
  const saved = localStorage.getItem(THEME_KEY) || "dark";
  document.documentElement.setAttribute("data-theme", saved);
})();
function toggleTheme(){
  const cur = document.documentElement.getAttribute("data-theme") || "dark";
  const next = (cur === "dark") ? "light" : "dark";
  document.documentElement.setAttribute("data-theme", next);
  localStorage.setItem(THEME_KEY, next);
}

/* API Base */
function getApiBase(){
  const d = JSON.parse(localStorage.getItem("baseone_settings_v3") || "{}");
  const base = (d.backend || location.origin).trim();
  return base.replace(/\/+$/,"");
}
const API_BASE = getApiBase();
document.addEventListener("DOMContentLoaded", ()=> {
  const el = document.getElementById("sv");
  if(el) el.textContent = API_BASE;
});

/* Utils */
function escapeHtml(s){ return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"); }
function copyAll(){ if(!topics.length){ alert("ì£¼ì œ ì—†ìŒ"); return; } navigator.clipboard.writeText(topics.map(x=>x.title).join("\n")); alert("ì „ì²´ ë³µì‚¬ ì™„ë£Œ!"); }
function setProgress(pct){
  const v = Math.max(0, Math.min(100, Math.round(Number(pct)||0)));
  document.getElementById("progBar").style.width = v + "%";
  document.getElementById("progText").textContent = `ì§„í–‰ë¥ : ${v}%`;
}

/* Log */
function toggleLog(){ const box=document.getElementById("logBox"); box.style.display = (box.style.display==="none" ? "block" : "none"); }
function clearLog(){ document.getElementById("log").innerHTML=""; setProgress(0); }
function logLine(icon, color, msg){
  const log=document.getElementById("log");
  const t=new Date();
  const time = String(t.getHours()).padStart(2,"0")+":"+String(t.getMinutes()).padStart(2,"0")+":"+String(t.getSeconds()).padStart(2,"0");
  log.innerHTML += `<div style="color:${color}">${icon} <b>[${time}]</b> ${escapeHtml(msg)}</div>`;
  log.scrollTop = log.scrollHeight;
}
function logInfo(m){ logLine("ğŸŸ¦","var(--text)",m); }
function logOk(m){ logLine("âœ…","var(--good)",m); }
function logErr(m){ logLine("âŒ","var(--danger)",m); }

/* Blog select (settings v3) */
function loadBlogsToSelect(){
  const sel=document.getElementById("blogSelect");
  const now=document.getElementById("blogNow");
  sel.innerHTML="";

  const v3 = JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  const blogspot = (v3.blogspot||[]);
  const naver = (v3.naver||[]);

  const options=[];
  blogspot.filter(Boolean).forEach((b,i)=>options.push({type:"blogspot", ...b, label:`ğŸŸ¦ ë¸”ë¡œê·¸ìŠ¤íŒŸ ${i+1} - ${b.name||b.url||""}`}));
  naver.filter(Boolean).forEach((b,i)=>options.push({type:"naver", ...b, label:`ğŸŸ© ë„¤ì´ë²„ ${i+1} - ${b.name||b.url||""}`}));

  if(!options.length){
    const opt=document.createElement("option");
    opt.value=""; opt.textContent="ì €ì¥ëœ ë¸”ë¡œê·¸ ì—†ìŒ â†’ ì„¤ì •(/settings)ì—ì„œ ì €ì¥";
    sel.appendChild(opt);
    now.textContent="-";
    return;
  }

  options.forEach(o=>{
    const opt=document.createElement("option");
    opt.value=JSON.stringify(o);
    opt.textContent=o.label;
    sel.appendChild(opt);
  });

  const last=localStorage.getItem("baseone_last_blog");
  if(last){
    for(let i=0;i<sel.options.length;i++){
      if(sel.options[i].value===last){sel.selectedIndex=i;break;}
    }
  }
  updateBlogNow();
}
function updateBlogNow(){
  const sel=document.getElementById("blogSelect");
  const now=document.getElementById("blogNow");
  const v=sel.value;
  if(!v){ now.textContent="-"; return; }
  localStorage.setItem("baseone_last_blog", v);
  try{
    const obj=JSON.parse(v);
    now.textContent=`${obj.type} / ${obj.name||""} / ${obj.url||""} ${obj.id?("(blog_id="+obj.id+")"):""}`;
  }catch(e){ now.textContent="-"; }
}
function getSelectedBlog(){
  const v=document.getElementById("blogSelect").value;
  if(!v) return null;
  try{ return JSON.parse(v); }catch(e){ return null; }
}
document.addEventListener("change",(e)=>{ if(e.target && e.target.id==="blogSelect") updateBlogNow(); });

/* OAuth + Sync blogs */
function startOAuth(){
  window.open(API_BASE + "/oauth/start", "_blank");
}
async function syncBloggerBlogs(){
  try{
    logInfo("ë¸”ë¡œê·¸ìŠ¤íŒŸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...");
    const res = await fetch(API_BASE + "/api/blogger/blogs");
    const j = await res.json().catch(()=>({}));
    if(!res.ok || !j.ok){
      alert("ì‹¤íŒ¨: " + (j.error || "OAuth í•„ìš”"));
      logErr("ì‹¤íŒ¨: " + (j.error || "OAuth í•„ìš”"));
      return;
    }
    // settings v3ì— blogspot ëª©ë¡ ì €ì¥
    const v3 = JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
    v3.blogspot = (j.items||[]).map(b=>({id:b.id, name:b.name, url:b.url}));
    localStorage.setItem("baseone_settings_v3", JSON.stringify(v3));
    logOk("ë¸”ë¡œê·¸ìŠ¤íŒŸ ëª©ë¡ ì €ì¥ ì™„ë£Œ!");
    loadBlogsToSelect();
    alert("ë¸”ë¡œê·¸ìŠ¤íŒŸ ëª©ë¡ ì €ì¥ ì™„ë£Œ!");
  }catch(e){
    logErr("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
    alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
  }
}

/* Categories + Topics */
const CATS=[
  {k:"ëˆ/ì¬í…Œí¬", s:"ğŸ’° ì ˆì•½Â·ì„¸ê¸ˆ"},
  {k:"ìƒí™œ/ê°€ì „", s:"ğŸ  ìƒí™œë¹„ ì ˆì•½"},
  {k:"ì»´í“¨í„°/IT", s:"ğŸ’» ìƒì‚°ì„±Â·ë³´ì•ˆ"},
  {k:"ì—¬í–‰", s:"ğŸ§³ ê²½ë¹„ ì ˆì•½"},
  {k:"ê±´ê°•", s:"ğŸƒ ë£¨í‹´Â·ê´€ë¦¬"},
  {k:"ê³µë¶€/ìê²©ì¦", s:"ğŸ“š í•©ê²© ê°€ì´ë“œ"},
  {k:"ë³´í—˜/ëŒ€ì¶œ", s:"ğŸ’³ ê¸ˆìœµ ìµœì í™”"},
  {k:"ì„¸ê¸ˆ/ì—°ë§ì •ì‚°", s:"ğŸ§¾ í™˜ê¸‰/ì ˆì„¸"},
];
const catGrid=document.getElementById("catGrid");
CATS.forEach(obj=>{
  const d=document.createElement("div");
  d.className="cat";
  d.onclick=()=>makeTopics(obj.k);
  d.innerHTML = `<b>${obj.k}</b><div class="desc">${obj.s}</div>`;
  catGrid.appendChild(d);
});

let topics=[]; let selectedCat=""; let selectedTopicId="";

function buildIdeas(cat, n=24){
  const hooks=["ì´ˆë³´ë„ ë°”ë¡œ ë˜ëŠ”","ì‹¤íŒ¨ ì—†ëŠ”","ëˆ ìƒˆëŠ” êµ¬ë© ë§‰ëŠ”","ì˜¤ëŠ˜ë¶€í„° ì ìš© ê°€ëŠ¥í•œ","ì •ë¦¬ í•œ ë²ˆì— ëë‚´ëŠ”","ì‹¤ì œ ì‚¬ë¡€ë¡œ ë³´ëŠ”"];
  const basesByCat={
    "ëˆ/ì¬í…Œí¬":["ì›” {x}ë§Œì› ê³ ì •ë¹„ ì¤„ì´ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸","ì¹´ë“œ í˜œíƒ 200% ì“°ëŠ” ë²•","í†µì‹ ë¹„/êµ¬ë…ë£Œ ì¤„ì´ëŠ” ìˆœì„œ","ë¹„ìƒê¸ˆ í†µì¥ ë§Œë“œëŠ” ë²•","ê°€ê³„ë¶€ ì—†ì´ ì˜ˆì‚°ê´€ë¦¬"],
    "ìƒí™œ/ê°€ì „":["ì „ê¸°ìš”ê¸ˆ ì¤„ì´ëŠ” ìŠµê´€","ê²¨ìš¸ ë‚œë°©ë¹„ ì ˆì•½ë²•","ê°€ì „ ìˆ˜ëª… ëŠ˜ë¦¬ëŠ” ê´€ë¦¬ë²•","ì²­ì†Œ ì‹œê°„ ë°˜ìœ¼ë¡œ ì¤„ì´ëŠ” íŒ","ìƒí™œë¹„ ì ˆì•½ ì²´í¬ë¦¬ìŠ¤íŠ¸"],
    "ì»´í“¨í„°/IT":["PC ëŠë¦´ ë•Œ í•´ê²° ìˆœì„œ","ìœˆë„ìš° í•„ìˆ˜ ìµœì í™” ì„¤ì •","í”¼ì‹±/í•´í‚¹ ì˜ˆë°© ì²´í¬ë¦¬ìŠ¤íŠ¸","í¬ë¡¬ ìµœì í™”ë¡œ ì†ë„ ì˜¬ë¦¬ê¸°","ì‚¬ì§„/ì˜ìƒ ìš©ëŸ‰ ì¤„ì´ëŠ” ë²•"],
    "ì—¬í–‰":["ì£¼ë§ 1ë°•2ì¼ ê°€ì„±ë¹„ ì½”ìŠ¤","ì—¬í–‰ê²½ë¹„ ì¤„ì´ëŠ” ê¿€íŒ","ìˆ™ì†Œ ì‹¸ê²Œ ì¡ëŠ” ìˆœì„œ","ë¹„ ì˜¤ëŠ” ë‚  ì¼ì • ì¶”ì²œ","í•­ê³µê¶Œ/ìˆ™ë°• í• ì¸ ë°›ëŠ” ë²•"],
    "ê±´ê°•":["ë©´ì—­ë ¥ ë£¨í‹´","ì  ì˜ ì˜¤ëŠ” í™˜ê²½ ë§Œë“¤ê¸°","í”¼ê³¤í•  ë•Œ ì ê²€ ì²´í¬","ìš´ë™ ì´ˆë³´ ë£¨í‹´","ì‹ë‹¨ ê¸°ë³¸ ê°€ì´ë“œ"],
    "ê³µë¶€/ìê²©ì¦":["í•©ê²© ê³µë¶€ ë£¨í‹´","ì˜¤ë‹µë…¸íŠ¸ ì œëŒ€ë¡œ ë§Œë“œëŠ” ë²•","ì•”ê¸° íš¨ìœ¨ ì˜¬ë¦¬ëŠ” íŒ","ì‹œí—˜ ì§ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸","ê³„íš ì„¸ìš°ëŠ” ë°©ë²•"],
    "ë³´í—˜/ëŒ€ì¶œ":["ë³´í—˜ë£Œ ì¤„ì´ëŠ” ì ê²€í‘œ","ëŒ€ì¶œ ì´ì ì¤„ì´ëŠ” ë°©ë²•","ì‹ ìš©ì ìˆ˜ ê´€ë¦¬ ë£¨í‹´","ìë™ì°¨ë³´í—˜ ë¹„êµ íŒ","ì‹¤ì†/ì¢…í•©ë³´í—˜ ì²´í¬"],
    "ì„¸ê¸ˆ/ì—°ë§ì •ì‚°":["ì—°ë§ì •ì‚° í™˜ê¸‰ ëŠ˜ë¦¬ëŠ” í•­ëª©","ë†“ì¹˜ê¸° ì‰¬ìš´ ê³µì œ ì •ë¦¬","ë¶€ì–‘ê°€ì¡±/ì˜ë£Œë¹„ ê³µì œ íŒ","ì ˆì„¸ë¥¼ ìœ„í•œ ê¸°ë³¸ ì„¸íŒ…","ìì£¼ ë¬»ëŠ” Q&A"],
  };
  const bases = basesByCat[cat] || ["{cat} ê¸°ë³¸ ê°€ì´ë“œ","{cat} ì‹¤ìˆ˜ TOP {x}","{cat} ì²´í¬ë¦¬ìŠ¤íŠ¸"];
  const out=new Set();
  let tries=0;
  while(out.size<n && tries<400){
    tries++;
    const h = hooks[Math.floor(Math.random()*hooks.length)];
    const b = bases[Math.floor(Math.random()*bases.length)];
    const x = 5 + Math.floor(Math.random()*6);
    out.add((h+" "+b).replaceAll("{x}", String(x)).replaceAll("{cat}", cat).trim());
  }
  return Array.from(out);
}
function makeTopics(cat){
  selectedCat=cat;
  const titles=buildIdeas(cat, 24);
  topics = titles.map((t,i)=>({id:`${Date.now()}_${i}`, title:t}));
  selectedTopicId = topics[0]?.id || "";
  renderTopics();
}
function getSelectedTitle(){ return topics.find(x=>x.id===selectedTopicId)?.title || ""; }

function renderTopics(){
  const q=(document.getElementById("filter").value||"").trim().toLowerCase();
  const box=document.getElementById("topicList");
  box.innerHTML="";
  let arr=topics.slice();
  if(q) arr=arr.filter(x=>x.title.toLowerCase().includes(q));
  if(!arr.length){
    box.innerHTML=`<div class="small">ì£¼ì œê°€ ì—†ìŠµë‹ˆë‹¤. ì¹´í…Œê³ ë¦¬ë¥¼ ë¨¼ì € ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>`;
    return;
  }
  arr.forEach(it=>{
    const d=document.createElement("div");
    d.className="item"+(it.id===selectedTopicId?" active":"");
    d.onclick=()=>{ selectedTopicId=it.id; renderTopics(); };
    const safeTitle = it.title.replaceAll("'","\\'");
    d.innerHTML=`
      <div style="flex:1">
        <div class="itemTitle">${escapeHtml(it.title)}</div>
        <div class="itemMeta">ğŸ·ï¸ ${escapeHtml(selectedCat || "-")}</div>
      </div>
      <button class="btn" onclick="event.stopPropagation(); navigator.clipboard.writeText('${safeTitle}'); alert('ë³µì‚¬ ì™„ë£Œ!');">ë³µì‚¬</button>
    `;
    box.appendChild(d);
  });
}

/* AI Generate */
async function aiGenerate(){
  const blog=getSelectedBlog();
  const title=getSelectedTitle();
  if(!blog){ alert("ë¸”ë¡œê·¸ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”"); return; }
  if(!title){ alert("ì£¼ì œë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”"); return; }

  document.getElementById("previewBox").style.display="none";
  setProgress(5);
  logInfo(`ğŸ§  ì£¼ì œ: ${title}`);
  logInfo(`ğŸ·ï¸ ì¹´í…Œê³ ë¦¬: ${selectedCat || "-"}`);

  const v3 = JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  const payload={
    topic:title,
    category:selectedCat,
    img_provider:(v3.img_provider || "pexels"),
    pexels_key:(v3.pexels_key || "")
  };

  try{
    setProgress(20);
    const res=await fetch(API_BASE+"/api/generate",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(payload)
    });
    const data=await res.json().catch(()=> ({}));
    if(!res.ok || !data.ok){
      setProgress(0);
      logErr("ìƒì„± ì‹¤íŒ¨: " + (data.error || "unknown"));
      alert("ìƒì„± ì‹¤íŒ¨: " + (data.error || "unknown"));
      return;
    }

    setProgress(80);
    logOk("ìƒì„± ì™„ë£Œ");

    const body = data.html || "";
    document.getElementById("finalBody").textContent = body;
    document.getElementById("finalImage").textContent = (data.image_url || "");
    document.getElementById("previewMeta").textContent =
      `ğŸ§  ${data.topic||title} / ğŸ·ï¸ ${data.category||selectedCat||"-"} / â±ï¸ ${data.generated_at||""}`;

    const iframe=document.getElementById("previewIframe");
    iframe.srcdoc = `<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
      <style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;padding:16px;line-height:1.7}</style>
      </head><body>${body}</body></html>`;

    const img=document.getElementById("previewImg");
    const hint=document.getElementById("imgHint");
    if(data.image_url){
      img.src=data.image_url;
      img.style.display="block";
      hint.style.display="none";
    }else{
      img.style.display="none";
      hint.style.display="block";
    }

    document.getElementById("previewBox").style.display="block";
    setProgress(100);

  }catch(e){
    setProgress(0);
    logErr("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
    alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨! ì„¤ì •ì˜ ì„œë²„ ì£¼ì†Œ(API_BASE)ë¥¼ í™•ì¸í•˜ì„¸ìš”.");
  }
}

/* Preview Window */
function openPreviewWindow(){
  const body = document.getElementById("finalBody")?.textContent?.trim() || "";
  if(!body){ alert("ë³¸ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € AI ìƒì„±í•˜ì„¸ìš”."); return; }
  const w = window.open("", "_blank");
  w.document.open();
  w.document.write(`<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ë¯¸ë¦¬ë³´ê¸°</title>
    <style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;padding:16px;line-height:1.7}</style>
  </head><body>${body}</body></html>`);
  w.document.close();
}

/* Publish (REAL for blogspot only) */
async function publishNow(){
  const blog=getSelectedBlog();
  const title=getSelectedTitle();
  const html = document.getElementById("finalBody")?.textContent?.trim() || "";

  if(!blog || !title){ alert("ë¸”ë¡œê·¸ì™€ ì£¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”"); return; }
  if(!html){ alert("ë¨¼ì € AI ìƒì„± í›„ ë°œí–‰í•˜ì„¸ìš”!"); return; }

  if(blog.type === "naver"){
    alert("ë„¤ì´ë²„ ë¸”ë¡œê·¸ëŠ” ì´ í”„ë¡œê·¸ë¨ì—ì„œ 'ìë™ ë°œí–‰'ì„ ê¸°ë³¸ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\në³¸ë¬¸/ì´ë¯¸ì§€ ë³µì‚¬ í›„ ë„¤ì´ë²„ ì—ë””í„°ì— ë¶™ì—¬ë„£ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.");
    return;
  }

  if(blog.type !== "blogspot"){
    alert("í˜„ì¬ ìë™ë°œí–‰ì€ ë¸”ë¡œê·¸ìŠ¤íŒŸ(blogspot)ë§Œ ì§€ì›í•©ë‹ˆë‹¤.");
    return;
  }

  if(!blog.id){
    alert("ë¸”ë¡œê·¸ìŠ¤íŒŸ blog_idê°€ ì—†ìŠµë‹ˆë‹¤.\n[ğŸ” ë¸”ë¡œê·¸ìŠ¤íŒŸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°]ë¡œ blog_idë¥¼ ë¨¼ì € ì €ì¥í•˜ì„¸ìš”.");
    return;
  }

  setProgress(10);
  logInfo("ğŸš€ ë¸”ë¡œê·¸ìŠ¤íŒŸ ì¦‰ì‹œë°œí–‰ ìš”ì²­...");

  try{
    const res = await fetch(API_BASE + "/api/blogger/post", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({
        blog_id: blog.id,
        title: title,
        html: html
      })
    });
    const j = await res.json().catch(()=> ({}));

    if(!res.ok || !j.ok){
      setProgress(0);
      logErr("ë°œí–‰ ì‹¤íŒ¨: " + (j.error || "unknown"));
      alert("ë°œí–‰ ì‹¤íŒ¨: " + (j.error || "unknown"));
      return;
    }

    setProgress(100);
    logOk("ë°œí–‰ ì™„ë£Œ!");
    if(j.url) logOk("URL: " + j.url);
    alert("ë°œí–‰ ì™„ë£Œ!\n" + (j.url || ""));

  }catch(e){
    setProgress(0);
    logErr("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
    alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
  }
}

/* init */
loadBlogsToSelect();
renderTopics();
</script>
</body>
</html>

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BaseOne - ìˆ˜ìµí˜• ê¸€ ìë™í™”</title>
<style>
body{margin:0;font-family:"Noto Sans KR",system-ui;background:#0f1630;color:#fff}
.wrap{max-width:900px;margin:0 auto;padding:16px}
.box{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:12px;margin:12px 0}
.row{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}
button,select,input{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.08);color:#fff}
button{cursor:pointer;font-weight:700}
.primary{background:linear-gradient(135deg,#7aa7ff,#38e1c1);border:none}
.list{max-height:280px;overflow:auto;margin-top:10px}
.item{padding:8px;border:1px solid rgba(255,255,255,.15);border-radius:10px;margin-bottom:6px;cursor:pointer}
.item.active{border-color:#7aa7ff;background:rgba(122,167,255,.15)}
.small{font-size:12px;opacity:.8}
textarea{width:100%;min-height:180px}
iframe{width:100%;height:300px;border:0}
</style>
</head>
<body>
<div class="wrap">

<h2>BaseOne â€“ ìˆ˜ìµí˜• ìë™ ê¸€ì“°ê¸°</h2>

<div class="box">
  <b>1) ë¸”ë¡œê·¸ ì„ íƒ</b><br>
  <select id="blogSelect"></select>
  <div class="small">í˜„ì¬: <span id="blogNow">-</span></div>
</div>

<div class="box">
  <b>2) ìˆ˜ìµí˜• ì£¼ì œ ì„ íƒ</b>
  <div style="margin-top:6px">
    <button onclick="makeTopics('ëˆ/ì¬í…Œí¬')">ëˆ/ì¬í…Œí¬</button>
    <button onclick="makeTopics('ìƒí™œë¹„')">ìƒí™œë¹„</button>
    <button onclick="makeTopics('IT')">IT</button>
    <button onclick="makeTopics('ê±´ê°•')">ê±´ê°•</button>
  </div>
  <div class="list" id="topicList"></div>
  <button class="primary" onclick="aiGenerate()">âœ¨ AI ê¸€ ìƒì„±</button>
</div>

<div class="box" id="previewBox" style="display:none">
  <b>3) ìƒì„± ê²°ê³¼</b>
  <div class="small" id="meta">-</div>

  <h4>ë³¸ë¬¸</h4>
  <textarea id="finalBody"></textarea>

  <h4>ì´ë¯¸ì§€</h4>
  <input id="finalImage">
  <img id="previewImg" style="width:100%;margin-top:6px;display:none">

  <h4>HTML ë¯¸ë¦¬ë³´ê¸°</h4>
  <iframe id="previewIframe"></iframe>

  <button class="primary" onclick="publishNow()">ğŸš€ ì¦‰ì‹œ ë°œí–‰</button>
</div>

</div>

<script>
/* ---------- API BASE ---------- */
function getApiBase(){
  const s=JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  return (s.backend||"http://127.0.0.1:5000").replace(/\/+$/,"");
}
const API_BASE=getApiBase();

/* ---------- BLOG SELECT ---------- */
function loadBlogs(){
  const sel=document.getElementById("blogSelect");
  const now=document.getElementById("blogNow");
  sel.innerHTML="";
  const v3=JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  const blogs=(v3.blogspot||[]).map(u=>({type:"blogspot",url:u}));
  if(!blogs.length){
    sel.innerHTML=`<option>ì„¤ì •ì—ì„œ ë¸”ë¡œê·¸ ë¨¼ì € ì¶”ê°€</option>`;
    return;
  }
  blogs.forEach((b,i)=>{
    const o=document.createElement("option");
    o.value=JSON.stringify(b);
    o.textContent=`ë¸”ë¡œê·¸ ${i+1} - ${b.url}`;
    sel.appendChild(o);
  });
  updateBlog();
}
function updateBlog(){
  const v=document.getElementById("blogSelect").value;
  try{
    const o=JSON.parse(v);
    document.getElementById("blogNow").textContent=o.type+" / "+o.url;
  }catch(e){
    document.getElementById("blogNow").textContent="-";
  }
}
document.getElementById("blogSelect").onchange=updateBlog;
function getBlog(){
  try{return JSON.parse(document.getElementById("blogSelect").value)}catch(e){return null}
}

/* ---------- TOPICS ---------- */
let topics=[],selectedId="",selectedCat="";
function buildIdeas(cat){
  const base=[
    "ì›” 10ë§Œì› ì•„ë¼ëŠ” ë°©ë²•",
    "ê³ ì •ë¹„ ì¤„ì´ëŠ” ìˆœì„œ",
    "ì¹´ë“œ í˜œíƒ 200% ì“°ê¸°",
    "ì „ê¸°ìš”ê¸ˆ ì ˆì•½ë²•",
    "ë³´í—˜ë£Œ ì¤„ì´ê¸°"
  ];
  return base.map(b=>`${cat} - ${b}`);
}
function makeTopics(cat){
  selectedCat=cat;
  const arr=buildIdeas(cat);
  topics=arr.map((t,i)=>({id:"t"+i,title:t}));
  selectedId=topics[0]?.id||"";
  renderTopics();
}
function renderTopics(){
  const box=document.getElementById("topicList");
  box.innerHTML="";
  topics.forEach(t=>{
    const d=document.createElement("div");
    d.className="item"+(t.id===selectedId?" active":"");
    d.textContent=t.title;
    d.onclick=()=>{selectedId=t.id;renderTopics()};
    box.appendChild(d);
  });
}
function getTitle(){
  return topics.find(x=>x.id===selectedId)?.title||"";
}

/* ---------- AI GENERATE ---------- */
async function aiGenerate(){
  const blog=getBlog();
  const title=getTitle();
  if(!blog){alert("ë¸”ë¡œê·¸ ì„ íƒ");return;}
  if(!title){alert("ì£¼ì œ ì„ íƒ");return;}

  const s=JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  const payload={
    topic:title,
    category:selectedCat,
    img_provider:"pexels",
    pexels_key:s.pexels_key||""
  };

  const res=await fetch(API_BASE+"/api/generate",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(payload)
  });
  const data=await res.json();

  document.getElementById("previewBox").style.display="block";
  document.getElementById("finalBody").value=data.body_prompt||"";
  document.getElementById("finalImage").value=data.image_url||"";
  document.getElementById("meta").textContent=data.topic+" / "+data.category;

  const iframe=document.getElementById("previewIframe");
  iframe.srcdoc=`<html><body>${data.body_prompt||""}</body></html>`;

  const img=document.getElementById("previewImg");
  if(data.image_url){
    img.src=data.image_url;
    img.style.display="block";
  }else img.style.display="none";
}

/* ---------- PUBLISH ---------- */
async function publishNow(){
  const blog=getBlog();
  const title=getTitle();
  const html=document.getElementById("finalBody").value;
  if(!blog||!title||!html){alert("ì •ë³´ ë¶€ì¡±");return;}

  const payload={
    blog_id: blog.blog_id,
    title: title,
    html: html
  };

  const res=await fetch(API_BASE+"/api/blogger/post",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(payload)
  });
  const j=await res.json();
  if(!res.ok){alert("ì‹¤íŒ¨: "+(j.error||""));return;}
  alert("ë°œí–‰ ì™„ë£Œ!\n"+j.url);
}

/* ---------- INIT ---------- */
loadBlogs();
</script>
</body>
</html>
padding:16px}
.box{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:12px;margin:12px 0}
.row{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}
button,select,input{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.08);color:#fff}
button{cursor:pointer;font-weight:700}
.primary{background:linear-gradient(135deg,#7aa7ff,#38e1c1);border:none}
.list{max-height:280px;overflow:auto;margin-top:10px}
.item{padding:8px;border:1px solid rgba(255,255,255,.15);border-radius:10px;margin-bottom:6px;cursor:pointer}
.item.active{border-color:#7aa7ff;background:rgba(122,167,255,.15)}
.small{font-size:12px;opacity:.8}
textarea{width:100%;min-height:180px}
iframe{width:100%;height:300px;border:0}
</style>
</head>
<body>
<div class="wrap">

<h2>BaseOne â€“ ìˆ˜ìµí˜• ìë™ ê¸€ì“°ê¸°</h2>

<div class="box">
  <b>1) ë¸”ë¡œê·¸ ì„ íƒ</b><br>
  <select id="blogSelect"></select>
  <div class="small">í˜„ì¬: <span id="blogNow">-</span></div>
</div>

<div class="box">
  <b>2) ìˆ˜ìµí˜• ì£¼ì œ ì„ íƒ</b>
  <div style="margin-top:6px">
    <button onclick="makeTopics('ëˆ/ì¬í…Œí¬')">ëˆ/ì¬í…Œí¬</button>
    <button onclick="makeTopics('ìƒí™œë¹„')">ìƒí™œë¹„</button>
    <button onclick="makeTopics('IT')">IT</button>
    <button onclick="makeTopics('ê±´ê°•')">ê±´ê°•</button>
  </div>
  <div class="list" id="topicList"></div>
  <button class="primary" onclick="aiGenerate()">âœ¨ AI ê¸€ ìƒì„±</button>
</div>

<div class="box" id="previewBox" style="display:none">
  <b>3) ìƒì„± ê²°ê³¼</b>
  <div class="small" id="meta">-</div>

  <h4>ë³¸ë¬¸</h4>
  <textarea id="finalBody"></textarea>

  <h4>ì´ë¯¸ì§€</h4>
  <input id="finalImage">
  <img id="previewImg" style="width:100%;margin-top:6px;display:none">

  <h4>HTML ë¯¸ë¦¬ë³´ê¸°</h4>
  <iframe id="previewIframe"></iframe>

  <button class="primary" onclick="publishNow()">ğŸš€ ì¦‰ì‹œ ë°œí–‰</button>
</div>

</div>

<script>
/* ---------- API BASE ---------- */
function getApiBase(){
  const s=JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  return (s.backend||"http://127.0.0.1:5000").replace(/\/+$/,"");
}
const API_BASE=getApiBase();

/* ---------- BLOG SELECT ---------- */
function loadBlogs(){
  const sel=document.getElementById("blogSelect");
  const now=document.getElementById("blogNow");
  sel.innerHTML="";
  const v3=JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  const blogs=(v3.blogspot||[]).map(u=>({type:"blogspot",url:u}));
  if(!blogs.length){
    sel.innerHTML=`<option>ì„¤ì •ì—ì„œ ë¸”ë¡œê·¸ ë¨¼ì € ì¶”ê°€</option>`;
    return;
  }
  blogs.forEach((b,i)=>{
    const o=document.createElement("option");
    o.value=JSON.stringify(b);
    o.textContent=`ë¸”ë¡œê·¸ ${i+1} - ${b.url}`;
    sel.appendChild(o);
  });
  updateBlog();
}
function updateBlog(){
  const v=document.getElementById("blogSelect").value;
  try{
    const o=JSON.parse(v);
    document.getElementById("blogNow").textContent=o.type+" / "+o.url;
  }catch(e){
    document.getElementById("blogNow").textContent="-";
  }
}
document.getElementById("blogSelect").onchange=updateBlog;
function getBlog(){
  try{return JSON.parse(document.getElementById("blogSelect").value)}catch(e){return null}
}

/* ---------- TOPICS ---------- */
let topics=[],selectedId="",selectedCat="";
function buildIdeas(cat){
  const base=[
    "ì›” 10ë§Œì› ì•„ë¼ëŠ” ë°©ë²•",
    "ê³ ì •ë¹„ ì¤„ì´ëŠ” ìˆœì„œ",
    "ì¹´ë“œ í˜œíƒ 200% ì“°ê¸°",
    "ì „ê¸°ìš”ê¸ˆ ì ˆì•½ë²•",
    "ë³´í—˜ë£Œ ì¤„ì´ê¸°"
  ];
  return base.map(b=>`${cat} - ${b}`);
}
function makeTopics(cat){
  selectedCat=cat;
  const arr=buildIdeas(cat);
  topics=arr.map((t,i)=>({id:"t"+i,title:t}));
  selectedId=topics[0]?.id||"";
  renderTopics();
}
function renderTopics(){
  const box=document.getElementById("topicList");
  box.innerHTML="";
  topics.forEach(t=>{
    const d=document.createElement("div");
    d.className="item"+(t.id===selectedId?" active":"");
    d.textContent=t.title;
    d.onclick=()=>{selectedId=t.id;renderTopics()};
    box.appendChild(d);
  });
}
function getTitle(){
  return topics.find(x=>x.id===selectedId)?.title||"";
}

/* ---------- AI GENERATE ---------- */
async function aiGenerate(){
  const blog=getBlog();
  const title=getTitle();
  if(!blog){alert("ë¸”ë¡œê·¸ ì„ íƒ");return;}
  if(!title){alert("ì£¼ì œ ì„ íƒ");return;}

  const s=JSON.parse(localStorage.getItem("baseone_settings_v3")||"{}");
  const payload={
    topic:title,
    category:selectedCat,
    img_provider:"pexels",
    pexels_key:s.pexels_key||""
  };

  const res=await fetch(API_BASE+"/api/generate",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(payload)
  });
  const data=await res.json();

  document.getElementById("previewBox").style.display="block";
  document.getElementById("finalBody").value=data.body_prompt||"";
  document.getElementById("finalImage").value=data.image_url||"";
  document.getElementById("meta").textContent=data.topic+" / "+data.category;

  const iframe=document.getElementById("previewIframe");
  iframe.srcdoc=`<html><body>${data.body_prompt||""}</body></html>`;

  const img=document.getElementById("previewImg");
  if(data.image_url){
    img.src=data.image_url;
    img.style.display="block";
  }else img.style.display="none";
}

/* ---------- PUBLISH ---------- */
async function publishNow(){
  const blog=getBlog();
  const title=getTitle();
  const html=document.getElementById("finalBody").value;
  if(!blog||!title||!html){alert("ì •ë³´ ë¶€ì¡±");return;}

  const payload={
    blog_id: blog.blog_id,
    title: title,
    html: html
  };

  const res=await fetch(API_BASE+"/api/blogger/post",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(payload)
  });
  const j=await res.json();
  if(!res.ok){alert("ì‹¤íŒ¨: "+(j.error||""));return;}
  alert("ë°œí–‰ ì™„ë£Œ!\n"+j.url);
}

/* ---------- INIT ---------- */
loadBlogs();
</script>
</body>
</html>


