<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BaseOne</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.08);
      --line: rgba(255,255,255,.10);
      --text:#eef2ff;
      --muted:rgba(238,242,255,.72);
      --accent:#6aa8ff;
      --accent2:#3a7bff;
      --shadow: 0 18px 44px rgba(0,0,0,.45);
      --radius:22px;
      --ok:#39d98a;
      --bad:#ff5a6a;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 680px at 10% 8%, rgba(106,168,255,.22), transparent 60%),
        radial-gradient(900px 620px at 82% 20%, rgba(255,102,196,.10), transparent 55%),
        radial-gradient(1200px 900px at 60% 110%, rgba(58,123,255,.10), transparent 65%),
        linear-gradient(180deg, #070a14 0%, var(--bg) 65%);
      min-height:100vh;
    }
    a{color:var(--accent); text-decoration:none}
    .wrap{max-width:1140px;margin:0 auto;padding:22px 16px 74px}
    .top{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      margin-bottom:14px;
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      font-weight:900; letter-spacing:.2px;
      font-size:28px;
    }
    .logo{
      width:40px;height:40px;border-radius:14px;
      background:
        radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,.55), transparent 60%),
        linear-gradient(180deg, rgba(106,168,255,1), rgba(58,123,255,1));
      box-shadow: 0 10px 26px rgba(58,123,255,.35);
      border:1px solid rgba(255,255,255,.18);
    }
    .chip{
      font-size:12px;color:var(--muted);
      padding:7px 10px;border:1px solid var(--line);
      border-radius:999px;background:rgba(255,255,255,.04)
    }
    .rightTop{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      border:none; cursor:pointer;
      padding:10px 12px;border-radius:14px;
      font-weight:900;
      background:rgba(255,255,255,.06);
      color:var(--text);
      border:1px solid var(--line);
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover{border-color: rgba(106,168,255,.35); background: rgba(255,255,255,.075)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      background: linear-gradient(180deg, rgba(106,168,255,1), rgba(58,123,255,1));
      border:none;
      box-shadow: 0 12px 30px rgba(58,123,255,.25);
    }
    .btn.primary:hover{filter:brightness(1.05)}
    .btn.ghost{background:rgba(255,255,255,.04)}
    .btn.small{padding:8px 10px;border-radius:12px;font-size:13px}
    .btn.copy{background:rgba(0,0,0,.18)}
    .btn.copy:hover{border-color: rgba(255,255,255,.20)}
    .grid{display:grid;grid-template-columns:1fr;gap:14px}
    @media(min-width:980px){.grid{grid-template-columns:1.15fr .85fr}}

    .card{
      background: var(--panel);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .card h2{margin:0 0 10px;font-size:18px}
    .desc{margin:0 0 14px;color:var(--muted);font-size:13px;line-height:1.55}

    /* Category (icon + color) */
    .categoryGrid{
      display:grid; grid-template-columns: repeat(2,1fr);
      gap:10px;
    }
    @media(min-width:760px){.categoryGrid{grid-template-columns: repeat(4,1fr)}}
    .cat{
      text-align:left;
      padding:12px 12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      font-weight:900;
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      position:relative;
      overflow:hidden;
    }
    .cat:hover{transform: translateY(-1px); border-color: rgba(106,168,255,.38); background: rgba(255,255,255,.07)}
    .cat .l{display:flex;align-items:center;gap:10px}
    .icon{
      width:34px;height:34px;border-radius:14px;
      display:grid;place-items:center;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      font-size:18px;
      flex:0 0 auto;
    }
    .cat .name{display:flex;flex-direction:column;gap:2px}
    .cat .name small{font-weight:800;color:var(--muted);font-size:12px}
    .swatch{
      width:10px;height:10px;border-radius:999px;
      box-shadow: 0 0 0 4px rgba(255,255,255,.06);
      flex:0 0 auto;
    }
    .cat::after{
      content:"";
      position:absolute; inset:-80px -60px auto auto;
      width:160px;height:160px;border-radius:999px;
      background: var(--glow, rgba(106,168,255,.18));
      filter: blur(2px);
      transform: rotate(18deg);
    }

    .two{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:760px){.two{grid-template-columns:1fr 1fr}}

    .box{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 18px;
      padding:12px;
    }
    .boxTitle{
      display:flex;justify-content:space-between;align-items:center;gap:10px;
      margin-bottom:10px;
    }
    .count{font-size:12px;color:var(--muted)}
    .tag{
      font-size:12px;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
      color:#d6dcff;
      white-space:nowrap;
    }

    .list{
      display:grid; gap:10px;
      max-height: 420px; overflow:auto; padding-right:4px;
    }

    /* Card style items */
    .topicCard{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      padding:12px;
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px;
    }
    .topicLeft{display:flex;gap:10px;align-items:flex-start}
    .badge{
      width:32px;height:32px;border-radius:14px;
      display:grid;place-items:center;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.10);
      font-weight:900;color:#cfd6ff;
      flex:0 0 auto;
    }
    .topicText{display:flex;flex-direction:column;gap:6px}
    .topicTitle{font-size:13px;font-weight:900;line-height:1.35}
    .topicMeta{display:flex;gap:8px;flex-wrap:wrap}
    .pill{
      font-size:12px;
      padding:5px 9px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.14);
      color:#d9deff;
    }

    select,input{
      width:100%;
      background: rgba(0,0,0,.18);
      color:var(--text);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding:11px 12px;
      outline:none;
    }
    .divider{height:1px;background: rgba(255,255,255,.08); margin:14px 0}

    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:rgba(0,0,0,.55);backdrop-filter: blur(10px);
      border:1px solid rgba(255,255,255,.10);
      padding:10px 12px;border-radius:14px;
      color:var(--text);font-size:13px;display:none;
      max-width: 92vw;
      box-shadow: 0 14px 30px rgba(0,0,0,.35);
      z-index:50;
    }

    /* Modal */
    .modalOverlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center; justify-content:center;
      padding:18px;
      z-index:60;
    }
    .modal{
      width:min(760px, 96vw);
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
      box-shadow: 0 24px 70px rgba(0,0,0,.55);
      backdrop-filter: blur(14px);
      padding:16px;
    }
    .modalTop{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      margin-bottom:10px;
    }
    .modalTitle{font-size:18px;font-weight:900}
    .modalClose{border:1px solid rgba(255,255,255,.14); background:rgba(0,0,0,.18)}
    .modalGrid{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:740px){.modalGrid{grid-template-columns:1fr 1fr}}
    .modalBox{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      border-radius: 18px;
      padding:12px;
    }
    .modalActions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;justify-content:flex-end}
    .tiny{font-size:12px;color:var(--muted);line-height:1.55}
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      padding:3px 6px;border-radius:8px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:#d6dcff;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo"></div>
        <div>
          BaseOne
          <div style="margin-top:6px">
            <span class="chip">ìˆ˜ìµí˜• í¬ìŠ¤íŒ… ë„êµ¬</span>
            <span class="chip">ì¹´ë“œí˜• Â· ë³µì‚¬ Â· íŒì—…ì˜ˆì•½</span>
          </div>
        </div>
      </div>

      <div class="rightTop">
        <a class="btn" href="./settings.html">âš™ ì„¤ì •</a>
        <button class="btn primary" onclick="openPlanner()">ğŸ“… ì˜ˆì•½ ë°œí–‰</button>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT -->
      <div class="card">
        <h2>ì¹´í…Œê³ ë¦¬ ì„ íƒ</h2>
        <p class="desc">ì¹´í…Œê³ ë¦¬ë¥¼ ëˆ„ë¥´ë©´ <b>ì£¼ì œ 50ê°œ</b>ê°€ ìƒì„±ë˜ê³ , ì•„ë˜ ì¹´ë“œì—ì„œ <b>ë³µì‚¬</b>í•  ìˆ˜ ìˆì–´ìš”.</p>

        <div class="categoryGrid" id="cats"></div>

        <div class="divider"></div>

        <div class="two">
          <div class="box">
            <div class="boxTitle">
              <b>ì£¼ì œ 50ê°œ</b>
              <span class="count" id="topicCount">0ê°œ</span>
            </div>
            <div class="list" id="topics"></div>
          </div>

          <div class="box">
            <div class="boxTitle">
              <b>ìˆ˜ìµí˜• ì£¼ì œ 100ê°œ</b>
              <span class="count" id="profitCount">0ê°œ</span>
            </div>
            <div class="rightTop" style="justify-content:flex-start;margin-bottom:10px">
              <button class="btn primary" onclick="makeProfit()">ìˆ˜ìµí˜• ì£¼ì œ ìƒì„±</button>
              <button class="btn ghost" onclick="clearProfit()">ë¹„ìš°ê¸°</button>
            </div>
            <div class="list" id="profit"></div>
          </div>
        </div>
      </div>

      <!-- RIGHT -->
      <div class="card">
        <h2>ë°œí–‰ ì¤€ë¹„</h2>
        <p class="desc">
          ì„¤ì •ì—ì„œ ì €ì¥í•œ ë¸”ë¡œê·¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì™€ì„œ ì„ íƒí•´ìš”.  
          ì˜ˆì•½ ë°œí–‰ì€ <b>íŒì—…(ëª¨ë‹¬)</b>ë¡œ ì—´ë¦½ë‹ˆë‹¤.
        </p>

        <div class="box">
          <div class="topicMeta" style="margin-bottom:10px">
            <span class="pill">1) ì„¤ì •ì—ì„œ ë¸”ë¡œê·¸ ì €ì¥</span>
            <span class="pill">2) ì£¼ì œ/ìˆ˜ìµí˜• ì£¼ì œ ë³µì‚¬</span>
            <span class="pill">3) ì˜ˆì•½ íŒì—…ì—ì„œ ì €ì¥</span>
          </div>

          <button class="btn primary" style="width:100%" onclick="openPlanner()">ğŸ“… ì˜ˆì•½ ë°œí–‰ ì—´ê¸°</button>

          <div class="tiny" style="margin-top:10px">
            íŒ: ì¹´ë“œì˜ <span class="kbd">ë³µì‚¬</span> ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì£¼ì œê°€ í´ë¦½ë³´ë“œë¡œ ë³µì‚¬ë©ë‹ˆë‹¤.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modalOverlay" id="modalOverlay" onclick="closeIfOutside(event)">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modalTop">
        <div>
          <div class="modalTitle">ì˜ˆì•½ ë°œí–‰</div>
          <div class="tiny">ì§€ê¸ˆì€ â€œì˜ˆì•½ ì €ì¥â€ê¹Œì§€ë§Œ ì§„í–‰ (ì„œë²„ ìë™í™”ëŠ” ë‹¤ìŒ ë‹¨ê³„)</div>
        </div>
        <button class="btn small modalClose" onclick="closePlanner()">ë‹«ê¸°</button>
      </div>

      <div class="modalGrid">
        <div class="modalBox">
          <div style="font-weight:900;margin-bottom:8px">ë°œí–‰í•  ë¸”ë¡œê·¸ ì„ íƒ</div>
          <select id="blogSelect"></select>
          <div class="tiny" style="margin-top:8px">
            ì„¤ì •(settings.html)ì—ì„œ ë¸”ë¡œê·¸ë¥¼ ì €ì¥í•´ë‘ë©´ ì—¬ê¸°ì— í‘œì‹œë¼ìš”.
          </div>
        </div>

        <div class="modalBox">
          <div style="font-weight:900;margin-bottom:8px">í•˜ë£¨ ë°œí–‰ ê°œìˆ˜</div>
          <input id="dailyCount" type="number" min="1" value="3"/>
          <div class="tiny" style="margin-top:8px">
            ì˜ˆ: 3ê°œ â†’ í•˜ë£¨ì— 3ê°œì”© ì˜ˆì•½ ì €ì¥
          </div>
        </div>

        <div class="modalBox" style="grid-column:1 / -1">
          <div style="font-weight:900;margin-bottom:8px">ì˜ˆì•½ ìƒíƒœ</div>
          <div class="tiny" id="planView">ì €ì¥ëœ ì˜ˆì•½ì´ ì—†ì–´ìš”.</div>
        </div>
      </div>

      <div class="modalActions">
        <button class="btn ghost" onclick="clearSchedule()">ì˜ˆì•½ ì‚­ì œ</button>
        <button class="btn" onclick="viewSchedule()">ì˜ˆì•½ ë³´ê¸°</button>
        <button class="btn primary" onclick="saveSchedule()">ì˜ˆì•½ ì €ì¥</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
  // ---------- Toast ----------
  function toast(msg){
    const t=document.getElementById("toast");
    t.textContent=msg;
    t.style.display="block";
    clearTimeout(window.__t);
    window.__t=setTimeout(()=>t.style.display="none", 2200);
  }

  // ---------- Categories with icon + color ----------
  const CATEGORY_META = [
    {name:"ê±´ê°•", icon:"ğŸ’ª", sub:"ëª¸/ê±´ê°•", glow:"rgba(57,217,138,.22)", dot:"#39d98a"},
    {name:"ì»´í“¨í„°/IT", icon:"ğŸ’»", sub:"ê¸°ìˆ /ë„êµ¬", glow:"rgba(106,168,255,.22)", dot:"#6aa8ff"},
    {name:"ìë™ì°¨", icon:"ğŸš—", sub:"ì •ë¹„/ë³´í—˜", glow:"rgba(255,168,76,.18)", dot:"#ffa84c"},
    {name:"ìƒí™œ/ê°€ì „", icon:"ğŸ ", sub:"ì‚´ë¦¼/ê°€ì „", glow:"rgba(174,120,255,.18)", dot:"#ae78ff"},
    {name:"ìœ¡ì•„", icon:"ğŸ‘¶", sub:"ìœ¡ì•„/êµìœ¡", glow:"rgba(255,102,196,.16)", dot:"#ff66c4"},
    {name:"ëˆ/ì¬í…Œí¬", icon:"ğŸ’¸", sub:"ì ˆì•½/íˆ¬ì", glow:"rgba(58,123,255,.22)", dot:"#3a7bff"},
    {name:"ì—¬í–‰", icon:"âœˆï¸", sub:"ì½”ìŠ¤/íŒ", glow:"rgba(80,220,255,.16)", dot:"#50dcff"},
    {name:"ìš”ë¦¬", icon:"ğŸ³", sub:"ë ˆì‹œí”¼", glow:"rgba(255,220,80,.16)", dot:"#ffdc50"},
    {name:"ìê¸°ê³„ë°œ", icon:"ğŸ“ˆ", sub:"ìŠµê´€/ëª©í‘œ", glow:"rgba(140,255,190,.14)", dot:"#8cffbe"},
    {name:"ê³µë¶€/ìê²©ì¦", icon:"ğŸ“š", sub:"ì‹œí—˜/ë£¨í‹´", glow:"rgba(255,170,200,.14)", dot:"#ffaaC8"},
    {name:"ë°˜ë ¤ë™ë¬¼", icon:"ğŸ¶", sub:"ì¼€ì–´/ìš©í’ˆ", glow:"rgba(180,255,120,.14)", dot:"#b4ff78"},
    {name:"íŒ¨ì…˜/ë·°í‹°", icon:"ğŸ’„", sub:"ê´€ë¦¬/í…œ", glow:"rgba(255,120,150,.14)", dot:"#ff7896"},
    {name:"ì·¨ë¯¸", icon:"ğŸ¨", sub:"ì·¨ë¯¸/DIY", glow:"rgba(160,200,255,.14)", dot:"#a0c8ff"},
    {name:"ìŠ¤í¬ì¸ ", icon:"âš½", sub:"ìš´ë™/ë£¨í‹´", glow:"rgba(120,255,220,.14)", dot:"#78ffdc"},
    {name:"ê²Œì„", icon:"ğŸ®", sub:"ë¦¬ë·°/íŒ", glow:"rgba(200,160,255,.14)", dot:"#c8a0ff"},
    {name:"ì˜í™”/ë“œë¼ë§ˆ", icon:"ğŸ¬", sub:"ì¶”ì²œ/ë¦¬ë·°", glow:"rgba(255,200,140,.14)", dot:"#ffc88c"},
  ];

  const catsEl=document.getElementById("cats");
  CATEGORY_META.forEach((c)=>{
    const b=document.createElement("button");
    b.className="cat";
    b.style.setProperty("--glow", c.glow);
    b.innerHTML = `
      <div class="l">
        <div class="icon">${c.icon}</div>
        <div class="name">
          <div>${c.name}</div>
          <small>${c.sub}</small>
        </div>
      </div>
      <div class="swatch" style="background:${c.dot}"></div>
    `;
    b.onclick=()=>makeTopics(c.name);
    catsEl.appendChild(b);
  });

  // ---------- Copy helper ----------
  async function copyText(text){
    try{
      await navigator.clipboard.writeText(text);
      toast("âœ… ë³µì‚¬ ì™„ë£Œ!");
    }catch(e){
      // fallback
      const ta=document.createElement("textarea");
      ta.value=text;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand("copy");
      ta.remove();
      toast("âœ… ë³µì‚¬ ì™„ë£Œ!");
    }
  }

  // ---------- Topics (50) - card + copy button ----------
  function makeTopics(category){
    const topics=document.getElementById("topics");
    topics.innerHTML="";
    for(let i=1;i<=50;i++){
      const title = `${category} ê¸€ ì•„ì´ë””ì–´ ${i}`;
      const el=document.createElement("div");
      el.className="topicCard";
      el.innerHTML = `
        <div class="topicLeft">
          <div class="badge">${i}</div>
          <div class="topicText">
            <div class="topicTitle">${title}</div>
            <div class="topicMeta">
              <span class="pill">${category}</span>
              <span class="pill">ì£¼ì œ</span>
            </div>
          </div>
        </div>
        <button class="btn small copy" onclick="copyText('${escapeJs(title)}')">ë³µì‚¬</button>
      `;
      topics.appendChild(el);
    }
    document.getElementById("topicCount").textContent="50ê°œ";
    toast(`${category} ì£¼ì œ 50ê°œ ìƒì„±!`);
  }

  // ---------- Profit topics (100) - card + copy button ----------
  function makeProfit(){
    const profit=document.getElementById("profit");
    profit.innerHTML="";

    const samples = [
      "ë³´í—˜(ì‹¤ë¹„/ì•”ë³´í—˜) ë¹„êµ", "ì¹´ë“œ í˜œíƒ ìµœì í™”", "í†µì‹ ë¹„ ì ˆì•½", "ì „ê¸°ìš”ê¸ˆ ì ˆì•½",
      "ì •ë¶€ì§€ì›ê¸ˆ/ë³µì§€", "ì—°ê¸ˆ(IRP/ISA)", "ëŒ€ì¶œ ìƒì‹", "ë¶€ì—…/ì¬íƒ", "ì„¸ê¸ˆ/í™˜ê¸‰",
      "ë‹¤ì´ì–´íŠ¸/ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ", "í”¼ë¶€/íƒˆëª¨", "ì˜ì–‘ì œ ë¹„êµ", "ìœ¡ì•„í…œ ì¶”ì²œ", "ê°€ì „ ì¶”ì²œ",
      "ìë™ì°¨ ë³´í—˜/ì •ë¹„", "ì—¬í–‰ í• ì¸/íŠ¹ê°€", "ìê²©ì¦/ì‹œí—˜", "ë…¸íŠ¸ë¶/ê°€ì„±ë¹„",
      "ì²­ì†Œ/ì‚´ë¦¼íŒ", "ì´ì‚¬/ì •ë¦¬", "íœ´ëŒ€í°/ìš”ê¸ˆì œ", "ì¸í„°ë„·/TV ê²°í•©"
    ];

    for(let i=1;i<=100;i++){
      const base = samples[i % samples.length];
      const title = `ìˆ˜ìµí˜• ì£¼ì œ ${i}: ${base}`;
      const el=document.createElement("div");
      el.className="topicCard";
      el.innerHTML = `
        <div class="topicLeft">
          <div class="badge">${i}</div>
          <div class="topicText">
            <div class="topicTitle">${title}</div>
            <div class="topicMeta">
              <span class="pill">ìˆ˜ìµí˜•</span>
              <span class="pill">ì¶”ì²œ</span>
            </div>
          </div>
        </div>
        <button class="btn small copy" onclick="copyText('${escapeJs(title)}')">ë³µì‚¬</button>
      `;
      profit.appendChild(el);
    }
    document.getElementById("profitCount").textContent="100ê°œ";
    toast("ìˆ˜ìµí˜• ì£¼ì œ 100ê°œ ìƒì„±!");
  }

  function clearProfit(){
    document.getElementById("profit").innerHTML="";
    document.getElementById("profitCount").textContent="0ê°œ";
  }

  // ---------- Modal planner (popup) ----------
  const overlay = document.getElementById("modalOverlay");
  function openPlanner(){
    overlay.style.display="flex";
    loadBlogsToSelect();
    refreshPlanView();
  }
  function closePlanner(){
    overlay.style.display="none";
  }
  function closeIfOutside(e){
    if(e.target === overlay) closePlanner();
  }
  window.addEventListener("keydown", (e)=>{
    if(e.key === "Escape" && overlay.style.display === "flex") closePlanner();
  });

  // ---------- Blogs list from settings (baseone.blogs) ----------
  function loadBlogsToSelect(){
    const sel=document.getElementById("blogSelect");
    sel.innerHTML="";

    const blogs = JSON.parse(localStorage.getItem("baseone.blogs")||"[]");
    if(!blogs.length){
      const opt=document.createElement("option");
      opt.value="";
      opt.textContent="ì„¤ì •ì—ì„œ ë¸”ë¡œê·¸ë¥¼ ë¨¼ì € ì €ì¥í•˜ì„¸ìš”";
      sel.appendChild(opt);
      return;
    }

    blogs.forEach((b, idx)=>{
      const opt=document.createElement("option");
      const type = (b.type||"").toUpperCase();
      const name = b.name ? b.name : "ì´ë¦„ì—†ìŒ";
      opt.value=idx;
      opt.textContent=`${type} Â· ${name} Â· ${b.url}`;
      sel.appendChild(opt);
    });
  }

  // ---------- Schedule save (localStorage) ----------
  const LS_PLAN="baseone.plan.v2";

  function saveSchedule(){
    const blogs = JSON.parse(localStorage.getItem("baseone.blogs")||"[]");
    const selIdx = document.getElementById("blogSelect").value;
    const daily = parseInt(document.getElementById("dailyCount").value || "3", 10);

    if(!blogs.length){ toast("ì„¤ì •ì—ì„œ ë¸”ë¡œê·¸ë¥¼ ë¨¼ì € ì €ì¥í•˜ì„¸ìš”!"); return; }
    if(selIdx === ""){ toast("ë¸”ë¡œê·¸ë¥¼ ì„ íƒí•˜ì„¸ìš”!"); return; }
    if(!daily || daily < 1){ toast("í•˜ë£¨ ë°œí–‰ ê°œìˆ˜ëŠ” 1 ì´ìƒ!"); return; }

    const picked = blogs[parseInt(selIdx, 10)];
    const data = { blog: picked, dailyCount: daily, savedAt: new Date().toISOString() };

    localStorage.setItem(LS_PLAN, JSON.stringify(data));
    toast("âœ… ì˜ˆì•½ ì €ì¥ ì™„ë£Œ!");
    refreshPlanView();
  }

  function viewSchedule(){
    const raw = localStorage.getItem(LS_PLAN);
    if(!raw){ toast("ì €ì¥ëœ ì˜ˆì•½ì´ ì—†ì–´ìš”"); return; }
    const data = JSON.parse(raw);
    alert(
      "ì˜ˆì•½ ì •ë³´\n\n" +
      "ë¸”ë¡œê·¸: " + (data.blog.name || "ì´ë¦„ì—†ìŒ") + "\n" +
      "ì¢…ë¥˜: " + data.blog.type + "\n" +
      "ì£¼ì†Œ: " + data.blog.url + "\n" +
      "í•˜ë£¨ ë°œí–‰: " + data.dailyCount + "ê°œ\n" +
      "ì €ì¥ì‹œê°„: " + data.savedAt
    );
  }

  function clearSchedule(){
    localStorage.removeItem(LS_PLAN);
    toast("ì˜ˆì•½ ì‚­ì œ ì™„ë£Œ");
    refreshPlanView();
  }

  function refreshPlanView(){
    const out = document.getElementById("planView");
    const raw = localStorage.getItem(LS_PLAN);
    if(!raw){
      out.textContent = "ì €ì¥ëœ ì˜ˆì•½ì´ ì—†ì–´ìš”.";
      return;
    }
    const d = JSON.parse(raw);
    out.innerHTML =
      `âœ… ì €ì¥ë¨<br>` +
      `ë¸”ë¡œê·¸: <b>${escapeHtml(d.blog.name || "ì´ë¦„ì—†ìŒ")}</b> (${escapeHtml(d.blog.type)})<br>` +
      `ì£¼ì†Œ: ${escapeHtml(d.blog.url)}<br>` +
      `í•˜ë£¨ ë°œí–‰: ${escapeHtml(String(d.dailyCount))}ê°œ<br>` +
      `ì €ì¥ì‹œê°„: ${escapeHtml(d.savedAt)}`;
  }

  // ---------- helpers ----------
  function escapeJs(s){
    return String(s)
      .replaceAll("\\","\\\\")
      .replaceAll("'","\\'")
      .replaceAll("\n","\\n")
      .replaceAll("\r","\\r");
  }
  function escapeHtml(s){
    return String(s)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }
</script>
</body>
</html>
